% !TEX ROOT=./main.tex



\section{Strongly Convex Smooth Objectives}

In this section, we show that FedAvg with SGD and Nesterov Accelerated SGD has $O(1/NT)$ rate under $\mu$-strong
convexity and $L$-smoothness. The result improves on previous results of
$O(1/T)$ with a linear speedup in the number of devices $N$.

\subsection{SGD}

\begin{theorem}
	Suppose $F_{k}$ is $L$-smooth and $\mu$-strongly convex for all
	$k$. Let $\kappa=\frac{L}{\mu}$, $\gamma=\max\{8\kappa-1,E\}$ where
	$E$ is the communication interval, and learning rates 
	\begin{align*}
	\alpha_{t} & =\frac{c}{\mu(\gamma+t)}
	\end{align*}
	so that $\alpha_{t}\leq2\alpha_{t+E}$, and where $0\leq c\leq1$
	is small enough such that
	$\alpha_{t} \leq\frac{1}{4L}$ and 
	$\alpha_{t} \leq\frac{1}{N}$ for all $t\geq0$. 
	
	Then with full device participation, if $\nu_{max}=\max_{k}\frac{1}{N}p_{k}$,
	we have 
	\begin{align*}
	\mathbb{E}F(\overline{w}_{T})-F^{\ast}\leq C\frac{\kappa}{\gamma+T}\cdot(8E^{2}LG^{2}/T+\frac{1}{N}\nu_{max}^{2}\sigma^{2})
	\end{align*}
	so that as long as $E=O(\sqrt{\frac{N}{T}})$, 
	\begin{align*}
	\mathbb{E}F(w_{T})-F^{\ast} & \leq C(8LG^{2}+\nu_{max}^{2}\sigma^{2})\frac{\kappa}{N(\gamma+T)}
	\end{align*}
	and with partial participation with $K$ sampled devices at each
	communication round, 
	\begin{align*}
	\mathbb{E}F(\overline{w}_{T})-F^{\ast}\leq C\frac{\kappa}{\gamma+T}\cdot(8E^{2}LG^{2}/T+\frac{1}{N}\nu_{max}^{2}\sigma^{2}+\frac{4}{K}E^{2}G^{2})
	\end{align*}
	so that if $E=O(1)$, 
	\begin{align*}
	\mathbb{E}F(\overline{w}_{T})-F^{\ast} & \leq C(4E^{2}G^{2}+\nu_{max}^{2}\sigma^{2})\frac{\kappa}{K(\gamma+T)}+\frac{8E^{2}LG^{2}}{T^{2}}
	\end{align*}
\end{theorem}
\begin{proof}
	See the appendix.
\end{proof}


The convergence result implies that with fixed $E$, as long as $N$ satisfies $E=O(\sqrt{T/N})$, there is linear speedup. When $N$ exceeds an upper bound, however, linear speedup may fail to happen, and $T/N$ may remain constant, i.e. the number of iterations required for convergence may increase with $N$. 

\subsection{Accelerated SGD}
In this section, we show that FedAvg with Nesterov accelerated SGD updates enjoys similar convergence rates with linear speedup. 

The FedAv algorithm with Nesterov Accelerated
SGD follows the updates
\begin{align*}
y_{t+1}^{k} & =w_{t}^{k}-\alpha_{t}g_{t,k}\\
w_{t+1}^{k} & =\begin{cases}
y_{t+1}^{k}+\beta_{t}(y_{t+1}^{k}-y_{t}^{k}) & \text{if }t+1\notin\mathcal{I}_{E}\\
\sum_{k=1}^{N}p_{k}\left[y_{t+1}^{k}+\beta_{t}(y_{t+1}^{k}-y_{t}^{k})\right] & \text{if }t+1\in\mathcal{I}_{E}
\end{cases}
\end{align*}
where 
\begin{align*}
g_{t,k} & :=\nabla F_{k}(w_{t}^{k},\xi_{t}^{k})
\end{align*}
is the stochastic gradient.

\begin{theorem}
	Suppose $F_{k}$ is $L$-smooth and $\mu$-strongly convex for all
	$k$. Let $\kappa=\frac{L}{\mu}$, $\gamma=\max\{8\kappa-1,E\}$ where
	$E$ is the communication interval, and learning rates 
	\begin{align*}
	\alpha_{t} & =\frac{c}{\mu(\gamma+t)}\\
	\beta_{t} & \leq\alpha_{t}
	\end{align*}
	so that $\alpha_{t}\leq2\alpha_{t+E}$, and where $0\leq c\leq1$
	is small enough such that the following hold: 
	\begin{align*}
	\alpha_{t}^{2}+\beta_{t-1}^{2} & \leq\frac{1}{2}\\
	\alpha_{t} & \leq\frac{1}{4L}\\
	4\alpha_{t-1}^{2} & \leq\alpha_{t}
	\end{align*}
	for all $t\geq0$. Suppose also that $G$ is a constant satisfying
	$\mathbb{E}\|w_{0}-\alpha_{0}g_{0,k}\|^{2}=\mathbb{E}\|w_{0}-\alpha_{0}\nabla F_{k}(w_{0},\xi_{0}^{k})\|^{2}\leq G^{2}$
	for all $k$, and $\mathbb{E}\|g_{t,k}\|^{2}\leq G^{2}$ for all $t,k$. 
	
	Then with full device participation, if $\nu_{max}=\max_{k}\frac{1}{N}p_{k}$,
	we have 
	\begin{align*}
	\mathbb{E}F(\overline{w}_{T})-F^{\ast}\leq C\frac{\kappa}{\gamma+T}\cdot(32E^{2}LG^{2}/T+\frac{1}{N}\nu_{max}^{2}\sigma^{2})
	\end{align*}
	so that as long as $E=O(\sqrt{\frac{N}{T}})$, 
	\begin{align*}
	\mathbb{E}F(w_{T})-F^{\ast} & \leq C(32LG^{2}+\nu_{max}^{2}\sigma^{2})\frac{\kappa}{N(\gamma+T)}
	\end{align*}
	and with partial participation with $K$ sampled devices at each
	communication round, 
	\begin{align*}
	\mathbb{E}F(\overline{w}_{T})-F^{\ast}\leq C\frac{\kappa}{\gamma+T}\cdot(32E^{2}LG^{2}/T+\frac{1}{N}\nu_{max}^{2}\sigma^{2}+\frac{16}{K}E^{2}G^{2})
	\end{align*}
	so that if $E=O(1)$, 
	\begin{align*}
	\mathbb{E}F(\overline{w}_{T})-F^{\ast} & \leq C(16E^{2}G^{2}+\nu_{max}^{2}\sigma^{2})\frac{\kappa}{K(\gamma+T)}+\frac{32E^{2}LG^{2}}{T^{2}}
	\end{align*}
\end{theorem}