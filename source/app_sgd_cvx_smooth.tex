We first summarize some properties of $L$-smooth and $\mu$-strongly
convex functions. 
\begin{lemma}
	Let $F$ be a convex $L$-smooth function. Then we have the following
	inequalities:
	
	1. Quadratic upper bound: $0\leq F(w)-F(w')-\langle\nabla F(w'),w-w'\rangle\leq\frac{L}{2}\|w-w'\|^{2}$. 
	
	2. Coercivity: $\frac{1}{L}\|\nabla F(w)-\nabla F(w')\|^{2}\leq\langle\nabla F(w)-\nabla F(w'),w-w'\rangle$.
	
	3. Lower bound: $F(w)\geq F(w')+\langle\nabla F(w'),w-w'\rangle+\frac{1}{2L}\|\nabla F(w)-\nabla F(w')\|^{2}$.
	In particular, $\|\nabla F(w)\|^{2}\leq2L(F(w)-F(w^{\ast}))$.
	
	4. Optimality gap: $F(w)-F(w^{\ast})\leq$$\langle\nabla F(w),w-w^{\ast}\rangle$.
\end{lemma}
%
\begin{lemma}
	Let $F$ be a $\mu$-strongly convex function. Then 
	\begin{align*}
	F(w) & \leq F(w')+\langle\nabla F(w'),w-w'\rangle+\frac{1}{2\mu}\|\nabla F(w)-\nabla F(w')\|^{2}\\
	F(w)-F(w^{\ast}) & \leq\frac{1}{2\mu}\|\nabla F(w)\|^{2}
	\end{align*}
\end{lemma}
%
\begin{assumption}
	The stochastic gradients have bounded variance 
	\begin{align*}
	\mathbb{E}\|\nabla F_{k}(w_{t}^{k},\xi_{t}^{k})-\nabla F_{k}(w_{t}^{k})\|^{2} & \leq\sigma_{k}^{2}
	\end{align*}
	for all $k$. Moreover, the expected squared norm of stochastic gradients
	is uniformly bounded, 
	\begin{align*}
	\mathbb{E}\|\nabla F_{k}(w_{t}^{k},\xi_{t}^{k})\|^{2} & \leq G^{2}
	\end{align*}
\end{assumption}
\begin{theorem}
	Suppose $F_{k}$ is $L$-smooth and $\mu$-strongly convex for all
	$k$. Let $\kappa=\frac{L}{\mu}$, $\gamma=\max\{8\kappa-1,E\}$ where
	$E$ is the communication interval, and learning rates 
	\begin{align*}
	\alpha_{t} & =\frac{c}{\mu(\gamma+t)}
	\end{align*}
	so that $\alpha_{t}\leq2\alpha_{t+E}$, and where $0\leq c\leq1$
	is small enough such that
	$\alpha_{t} \leq\frac{1}{4L}$ and 
	$\alpha_{t} \leq\frac{1}{N}$ for all $t\geq0$. 
	
	Then with full device participation, if $\nu_{max}=\max_{k}\frac{1}{N}p_{k}$,
	we have 
	\begin{align*}
	\mathbb{E}F(\overline{w}_{T})-F^{\ast}\leq C\frac{\kappa}{\gamma+T}\cdot(8E^{2}LG^{2}/T+\frac{1}{N}\nu_{max}^{2}\sigma^{2})
	\end{align*}
	so that as long as $E=O(\sqrt{\frac{N}{T}})$, 
	\begin{align*}
	\mathbb{E}F(w_{T})-F^{\ast} & \leq C(8LG^{2}+\nu_{max}^{2}\sigma^{2})\frac{\kappa}{N(\gamma+T)}
	\end{align*}
	and with partial participation with $K$ sampled devices at each
	communication round, $\frac{4}{K}\alpha_{t}^{2}E^{2}G^{2}$
	\begin{align*}
	\mathbb{E}F(\overline{w}_{T})-F^{\ast}\leq C\frac{\kappa}{\gamma+T}\cdot(8E^{2}LG^{2}/T+\frac{1}{N}\nu_{max}^{2}\sigma^{2}+\frac{4}{K}E^{2}G^{2})
	\end{align*}
	so that if $E=O(1)$, 
	\begin{align*}
	\mathbb{E}F(\overline{w}_{T})-F^{\ast} & \leq C(4E^{2}G^{2}+\nu_{max}^{2}\sigma^{2})\frac{\kappa}{K(\gamma+T)}+\frac{8E^{2}LG^{2}}{T^{2}}
	\end{align*}
\end{theorem}

\begin{proof}
	The idea of the proof is to observe that the $L$-smoothness of $F$
	provides the upper bound
	\begin{align*}
	\mathbb{E}(F(\overline{w}_{t}))-F^{\ast} & =\mathbb{E}(F(\overline{w}_{t})-F(w^{\ast}))\\
	& \leq\frac{L}{2}\mathbb{E}\|\overline{w}_{t}-w^{\ast}\|^{2}
	\end{align*}
	and to show that $\mathbb{E}\|\overline{w}_{T}-w^{\ast}\|^{2}=O(\frac{1}{NT})$. 
	
	Our main step is to prove the bound 
	\begin{align*}
	\mathbb{E}\|\overline{w}_{t+1}-w^{\ast}\|^{2} & \leq(1-\mu\alpha_{t})\mathbb{E}\|\overline{w}_{t}-w^{\ast}\|^{2}+\alpha_{t}^{2}B
	\end{align*}
	where $B$ is define in the statement of the theorem. 
	
	We have 
	\begin{align*}
	\|\overline{w}_{t+1}-w^{\ast}\|^{2} & =\|(\overline{w}_{t}-\alpha_{t}g_{t})-w^{\ast}\|^{2}\\
	& =\|(\overline{w}_{t}-\alpha_{t}\overline{g}_{t}-w^{\ast})-\alpha_{t}(g_{t}-\overline{g}_{t})\|^{2}\\
	& =A_{1}+A_{2}+A_{3}
	\end{align*}
	where 
	\begin{align*}
	A_{1} & =\|\overline{w}_{t}-w^{\ast}-\alpha_{t}\overline{g}_{t}\|^{2}\\
	A_{2} & =2\alpha_{t}\langle\overline{w}_{t}-w^{\ast}-\alpha_{t}\overline{g}_{t},\overline{g}_{t}-g_{t}\rangle\\
	A_{3} & =\alpha_{t}^{2}\|g_{t}-\overline{g}_{t}\|^{2}
	\end{align*}
	$\mathbb{E}A_{2}=0$ by definition of $g_{t}$ and $\overline{g}_{t}$,
	while for $A_{3}$ we have
	\begin{align*}
	\alpha_{t}^{2}\mathbb{E}\|g_{t}-\overline{g}_{t}\|^{2} & =\alpha_{t}^{2}\mathbb{E}\|g_{t}-\mathbb{E}g_{t}\|^{2}=\alpha_{t}^{2}\sum_{k=1}^{N}p_{k}^{2}\|g_{t,k}-\mathbb{E}g_{t,k}\|^{2}\leq\alpha_{t}^{2}\sum_{k=1}^{N}p_{k}^{2}\sigma_{k}^{2}
	\end{align*}
	again by Jensen's inequality and using the independence of $g_{t,k},g_{t,k'}$. 
	
	Next we bound $A_{1}$: 
	\begin{align*}
	\|\overline{w}_{t}-w^{\ast}-\alpha_{t}\overline{g}_{t}\|^{2} & =\|\overline{w}_{t}-w^{\ast}\|^{2}+2\langle\overline{w}_{t}-w^{\ast},-\alpha_{t}\overline{g}_{t}\rangle+\|\alpha_{t}\overline{g}_{t}\|^{2}
	\end{align*}
	and we will show that the third term $\|\alpha_{t}\overline{g}_{t}\|^{2}$
	can be canceled by an upper bound of the second term. %
	\begin{comment}
	The last term is straightforward to bound by the convexity of $\|\cdot\|^{2}$
	and $L$-smoothness of $F_{k}$,
	\begin{align*}
	\alpha_{t}^{2}\|\overline{g}_{t}\|^{2} & \leq\alpha_{t}^{2}\sum_{k=1}^{N}p_{k}\|\nabla F_{k}(w_{t}^{k})\|^{2}\leq2L\alpha_{t}^{2}\sum_{k=1}^{N}p_{k}(F_{k}(w_{t}^{k})-F_{k}^{\ast})
	\end{align*}
	or 
	\begin{align*}
	\alpha_{t}^{2}\|\overline{g}_{t}\|^{2} & \leq\alpha_{t}^{2}\sum_{k=1}^{N}p_{k}\|\nabla F_{k}(w_{t}^{k})\|^{2}\leq\alpha_{t}^{2}\sum_{k=1}^{N}p_{k}\mathbb{E}\|\nabla F_{k}(w_{t}^{k},\xi_{t}^{k})\|^{2}\leq\alpha_{t}^{2}G^{2}
	\end{align*}
	\end{comment}
	
	Now 
	\begin{align*}
	-2\alpha_{t}\langle\overline{w}_{t}-w^{\ast},\overline{g}_{t}\rangle & =-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle\overline{w}_{t}-w^{\ast},\nabla F_{k}(w_{t}^{k})\rangle\\
	& =-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle\overline{w}_{t}-w_{t}^{k},\nabla F_{k}(w_{t}^{k})\rangle-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle w_{t}^{k}-w^{\ast},\nabla F_{k}(w_{t}^{k})\rangle\\
	& \leq-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle\overline{w}_{t}-w_{t}^{k},\nabla F_{k}(w_{t}^{k})\rangle+2\alpha_{t}\sum_{k=1}^{N}p_{k}(F_{k}(w^{\ast})-F_{k}(w_{t}^{k}))-\alpha_{t}\mu\sum_{k=1}^{N}p_{k}\|w_{t}^{k}-w^{\ast}\|^{2}\\
	& \leq2\alpha_{t}\sum_{k=1}^{N}p_{k}\left[F_{k}(w_{t}^{k})-F_{k}(\overline{w}_{t})+\frac{L}{2}\|\overline{w}_{t}-w_{t}^{k}\|^{2}+F_{k}(w^{\ast})-F_{k}(w_{t}^{k})\right]-\alpha_{t}\mu\|\sum_{k=1}^{N}p_{k}w_{t}^{k}-w^{\ast}\|^{2}\\
	& =\alpha_{t}L\sum_{k=1}^{N}p_{k}\|\overline{w}_{t}-w_{t}^{k}\|^{2}+2\alpha_{t}\sum_{k=1}^{N}p_{k}\left[F_{k}(w^{\ast})-F_{k}(\overline{w}_{t})\right]-\alpha_{t}\mu\|\overline{w}_{t}-w^{\ast}\|^{2}
	\end{align*}
	For the second term, which is negative, we can ignore it, but this
	yields a suboptimal bound that fails to provide the desired linear
	speedup. This is the flaw in the analysis of the ICLR paper. Instead,
	we upper bound it using the following derivation: 
	\begin{align*}
	2\alpha_{t}\sum_{k=1}^{N}p_{k}\left[F_{k}(w^{\ast})-F_{k}(\overline{w}_{t})\right] & \leq2\alpha_{t}\left[F(\overline{w}_{t+1})-F(\overline{w}_{t})\right]\\
	& \leq2\alpha_{t}\mathbb{E}\langle\nabla F(\overline{w}_{t}),\overline{w}_{t+1}-\overline{w}_{t}\rangle+\alpha_{t}L\mathbb{E}\|\overline{w}_{t+1}-\overline{w}_{t}\|^{2}\\
	& =-2\alpha_{t}^{2}\mathbb{E}\langle\nabla F(\overline{w}_{t}),g_{t}\rangle+\alpha_{t}^{3}L\mathbb{E}\|g_{t}\|^{2}\\
	& =-2\alpha_{t}^{2}\mathbb{E}\langle\nabla F(\overline{w}_{t}),\overline{g}_{t}\rangle+\alpha_{t}^{3}L\mathbb{E}\|g_{t}\|^{2}\\
	& =-\alpha_{t}^{2}\left[\|\nabla F(\overline{w}_{t})\|^{2}+\|\overline{g}_{t}\|^{2}-\|\nabla F(\overline{w}_{t})-\overline{g}_{t}\|^{2}\right]+\alpha_{t}^{3}L\mathbb{E}\|g_{t}\|^{2}\\
	& =-\alpha_{t}^{2}\left[\|\nabla F(\overline{w}_{t})\|^{2}+\|\overline{g}_{t}\|^{2}-\|\nabla F(\overline{w}_{t})-\sum_{k}p_{k}\nabla F(w_{t}^{k})\|^{2}\right]+\alpha_{t}^{3}L\mathbb{E}\|g_{t}\|^{2}\\
	& \leq-\alpha_{t}^{2}\left[\|\nabla F(\overline{w}_{t})\|^{2}+\|\overline{g}_{t}\|^{2}-\sum_{k}p_{k}\|\nabla F(\overline{w}_{t})-\nabla F(w_{t}^{k})\|^{2}\right]+\alpha_{t}^{3}L\mathbb{E}\|g_{t}\|^{2}\\
	& \leq-\alpha_{t}^{2}\left[\|\nabla F(\overline{w}_{t})\|^{2}+\|\overline{g}_{t}\|^{2}-L^{2}\sum_{k}p_{k}\|\overline{w}_{t}-w_{t}^{k}\|^{2}\right]+\alpha_{t}^{3}L\mathbb{E}\|g_{t}\|^{2}\\
	& \leq-\alpha_{t}^{2}\|\overline{g}_{t}\|^{2}+\alpha_{t}^{2}L^{2}\sum_{k}p_{k}\|\overline{w}_{t}-w_{t}^{k}\|^{2}+\alpha_{t}^{3}L\mathbb{E}\|g_{t}\|^{2}
	\end{align*}
	where we have used the smoothness of $F$ twice. 
	
	Note that the term $-\alpha_{t}^{2}\|\overline{g}_{t}\|^{2}$ exactly
	cancels the $\alpha_{t}^{2}\|\overline{g}_{t}\|^{2}$ in the bound
	for $A_{1}$, so that plugging in the bound for $-2\alpha_{t}\langle\overline{w}_{t}-w^{\ast},\overline{g}_{t}\rangle$,
	we have so far proved 
	\begin{align*}
	\mathbb{E}\|\overline{w}_{t+1}-w^{\ast}\|^{2} & \leq\mathbb{E}(1-\mu\alpha_{t})\|\overline{w}_{t}-w^{\ast}\|^{2}+\alpha_{t}L\sum_{k=1}^{N}p_{k}\|\overline{w}_{t}-w_{t}^{k}\|^{2}+\alpha_{t}^{2}\sum_{k=1}^{N}p_{k}^{2}\sigma_{k}^{2}\\
	& +\alpha_{t}^{2}L^{2}\sum_{k=1}^{N}p_{k}\|\overline{w}_{t}-w_{t}^{k}\|^{2}+\alpha_{t}^{3}L\mathbb{E}\|g_{t}\|^{2}
	\end{align*}
	The term $\mathbb{E}\|g_{t}\|^{2}\leq G^{2}$ by assumption. 
	
	Now we bound $\mathbb{E}\sum_{k=1}^{N}p_{k}\|\overline{w}_{t}-w_{t}^{k}\|^{2}$.
	Since communication is done every $E$ steps, for any $t\geq0$, we
	can find a $t_{0}\leq t$ such that $t-t_{0}\leq E-1$ and $w_{t_{0}}^{k}=\overline{w}_{t_{0}}$for
	all $k$. Moreover, using $\eta_{t}$ is non-increasing and $\alpha_{t_{0}}\leq\alpha{}_{t}$
	for any $t-t_{0}\leq E-1$, we have 
	\begin{align*}
	\mathbb{E}\sum_{k=1}^{N}p_{k}\|\overline{w}_{t}-w_{t}^{k}\|^{2} & =\mathbb{E}\sum_{k=1}^{N}p_{k}\|w_{t}^{k}-\overline{w}_{t_{0}}-(\overline{w}_{t}-\overline{w}_{t_{0}})\|^{2}\\
	& \leq\mathbb{E}\sum_{k=1}^{N}p_{k}\|w_{t}^{k}-\overline{w}_{t_{0}}\|^{2}\\
	& =\mathbb{E}\sum_{k=1}^{N}p_{k}\|w_{t}^{k}-w_{t_{0}}^{k}\|^{2}\\
	& =\mathbb{E}\sum_{k=1}^{N}p_{k}\|-\sum_{i=t_{0}}^{t-1}\alpha_{i}g_{i,k}\|^{2}\\
	& \leq\sum_{k=1}^{N}p_{k}\mathbb{E}\sum_{i=t_{0}}^{t-1}(E-1)\alpha_{i}^{2}\|g_{i,k}\|^{2}\\
	& \leq\sum_{k=1}^{N}p_{k}\mathbb{E}\sum_{i=t_{0}}^{t-1}(E-1)\alpha_{t_{0}}^{2}G^{2}\\
	& \leq4E^{2}\alpha_{t}^{2}G^{2}
	\end{align*}
	
	Using the bound on $\mathbb{E}\sum_{k=1}^{N}p_{k}\|\overline{w}_{t}-w_{t}^{k}\|^{2}$,
	we can conclude that, with $\nu_{max}:=N\cdot\max_{k}p_{k}$ and $\nu_{min}:=N\cdot\min_{k}p_{k}$, 
	
	\begin{align*}
	\mathbb{E}\|\overline{w}_{t+1}-w^{\ast}\|^{2} & \leq\mathbb{E}(1-\mu\alpha_{t})\|\overline{w}_{t}-w^{\ast}\|^{2}+4E^{2}L\alpha_{t}^{3}G^{2}+4E^{2}L^{2}\alpha_{t}^{4}G^{2}+\alpha_{t}^{2}\sum_{k=1}^{N}p_{k}^{2}\sigma_{k}^{2}+\alpha_{t}^{3}LG^{2}\\
	& =\mathbb{E}(1-\mu\alpha_{t})\|\overline{w}_{t}-w^{\ast}\|^{2}+4E^{2}L\alpha_{t}^{3}G^{2}+4E^{2}L^{2}\alpha_{t}^{4}G^{2}+\alpha_{t}^{2}\frac{1}{N^{2}}\sum_{k=1}^{N}(p_{k}N)^{2}\sigma_{k}^{2}+\alpha_{t}^{3}LG^{2}\\
	& \leq\mathbb{E}(1-\mu\alpha_{t})\|\overline{w}_{t}-w^{\ast}\|^{2}+4E^{2}L\alpha_{t}^{3}G^{2}+4E^{2}L^{2}\alpha_{t}^{4}G^{2}+\alpha_{t}^{2}\frac{1}{N^{2}}\nu_{max}^{2}\sum_{k=1}^{N}\sigma_{k}^{2}+\alpha_{t}^{3}LG^{2}\\
	& \leq\mathbb{E}(1-\mu\alpha_{t})\|\overline{w}_{t}-w^{\ast}\|^{2}+4E^{2}L\alpha_{t}^{3}G^{2}+4E^{2}L^{2}\alpha_{t}^{4}G^{2}+\alpha_{t}^{2}\frac{1}{N}\nu_{max}^{2}\sigma^{2}+\alpha_{t}^{3}LG^{2}
	\end{align*}
	where $\sigma^{2}=\max_{k}\sigma_{k}^{2}$. We show next that $\|\overline{w}_{t}-w^{\ast}\|^{2}=O(\frac{\alpha_{t}}{N})=O(\frac{1}{Nt})$.
	Before we do, we remark briefly on the choice of $E$. The leading
	term among terms other than $\mathbb{E}(1-\mu\alpha_{t})\|\overline{w}_{t}-w^{\ast}\|^{2}$
	is $\alpha_{t}^{2}\frac{1}{N}\nu_{max}^{2}\sigma^{2}$. This means
	we can take $E=O(\sqrt{\frac{1}{N\alpha_{t}}})=O(\sqrt{\frac{t}{N}})$
	which means $4E^{2}L\alpha_{t}^{3}G^{2}=O(\frac{\alpha_{t}}{N})$
	will be on the same order as the leading term. This is in contrast
	with previous results where $E$ cannot scale with $t$. Thus our
	bound yields a more efficient communication complexity than current
	analyses. We note however that this is only possible when there is
	full participation, and when $\nu_{max}$ is close to 1. When there
	is partial participation, however, $E$ has to stay $O(1)$, as we
	will soon see. Thus our result hightlights the difference between
	the communication efficiency of full and partial participation when
	an $O(1/T)$ bound on the optimality gap is desired. 
	
	\textbf{}%
	\begin{comment}
	The leading term on the right hand side the bound is $\alpha_{t}^{2}\frac{1}{N}\nu_{max}^{2}\sigma^{2}$,
	which when summed using the recursive relations gives $O(\alpha_{t})=O(1/t)$,
	but the constant now is scaled down by $1/N$. \textbf{To achieve
	this linear speedup, we need $\sum_{t=0}^{T}(1-\mu\alpha_{t})\|w_{0}-w^{\ast}\|^{2}$
	to be small enough. Note also that the above bound implies that $E$
	can be chosen to be as large as $O(\sqrt{\frac{T}{N}})$ without degrading
	the performance, since $E^{2}\alpha_{t}^{3}=O(\alpha_{t}^{2}/N)$
	which is the order of the leading term. As we will see, in the partial
	participation case, this is no longer true, and $E$ cannot be chosen
	$O(T^{\beta})$ for any $\beta>0$. }
	\end{comment}
	
	To complete the proof of convergence, let $B=$ $B_{t}=4E^{2}L\alpha_{t}G^{2}+4E^{2}L^{2}\alpha_{t}^{2}G^{2}+\frac{1}{N}\nu_{max}^{2}\sigma^{2}+\alpha_{t}LG^{2}$.
	Set the learning rate $\alpha_{t}=\frac{\delta}{t+\gamma}$ for $\delta>\frac{1}{\mu}$
	and $\gamma=\max\{8\kappa-1,E\}$ such that $\alpha_{1}\leq\min\{\frac{1}{\mu},\frac{1}{4L}\}$and
	$\alpha_{t}\leq2\alpha_{t+E}$, we can show that 
	\begin{align*}
	\mathbb{E}\|\overline{w}_{t}-w^{\ast}\|^{2} & \leq\frac{v}{N(\gamma+t)}
	\end{align*}
	where $v=\max\{\frac{\delta^{2}B}{\delta\mu-1},(\gamma+1)\|w_{0}-w^{\ast}\|^{2}\}$,
	by induction. The definition of $v$ ensures that 
	\begin{align*}
	\|w_{0}-w^{\ast}\|^{2} & \leq\frac{v}{\gamma}
	\end{align*}
	and suppose $\mathbb{E}\|\overline{w}_{t}-w^{\ast}\|^{2}\leq\frac{v}{N(\gamma+t)}$
	holds for some $t\geq0$. Then 
	\begin{align*}
	\mathbb{E}\|\overline{w}_{t+1}-w^{\ast}\|^{2}\leq & (1-\alpha_{t}\mu)\mathbb{E}\|\overline{w}_{t}-w^{\ast}\|^{2}+\alpha_{t}^{2}B'\\
	& \leq(1-\frac{\delta\mu}{t+\gamma})\frac{v}{N(t+\gamma)}+\frac{\delta^{2}B'}{N^{2}(t+\gamma)^{2}}\\
	& =\frac{t+\gamma-1}{N(t+\gamma)^{2}}v+\left[\frac{\delta^{2}B'}{N^{2}(t+\gamma)^{2}}-\frac{\delta\mu-1}{N(t+\gamma)^{2}}v\right]\\
	& \leq\frac{t+\gamma-1}{N(t+\gamma)^{2}}v+\left[\frac{\delta^{2}B'}{N(t+\gamma)^{2}}-\frac{\delta\mu-1}{N(t+\gamma)^{2}}v\right]\\
	& \leq\frac{1}{N}\frac{v}{t+\gamma+1}
	\end{align*}
	by definition of $v$.
	
	Finally, the $L$-smoothness of $F$ implies 
	\begin{align*}
	\mathbb{E}(F(\overline{w}_{t}))-F^{\ast} & =\mathbb{E}(F(\overline{w}_{t})-F(w^{\ast}))\\
	& \leq\frac{L}{2}\mathbb{E}\|\overline{w}_{t}-w^{\ast}\|^{2}\leq\frac{L}{2}\frac{v}{\gamma+t}
	\end{align*}
	Now if we choose $\delta=\frac{c}{\mu}$ where $c\leq1$ is small
	enough such that the required conditions 
	\begin{align*}
	\alpha_{t}^{2}+\beta_{t-1}^{2} & \leq\frac{1}{2}\\
	\alpha_{t} & \leq\frac{1}{4L}\\
	4\alpha_{t-1}^{2} & \leq\alpha_{t}
	\end{align*}
	hold for all $t\geq0$, $\gamma=\max\{8\kappa-1,E\}$, then $\alpha_{t}=\frac{c}{\mu}\frac{1}{\gamma+t}$
	and recalling $v=\max\{\frac{\delta^{2}B'}{\delta\mu-c+1},(\gamma+1)\|w_{0}-w^{\ast}\|^{2}\}$,
	we finally have 
	\begin{align*}
	\mathbb{E}(F(\overline{w}_{t}))-F^{\ast} & \leq\frac{L}{2}\frac{v}{\gamma+t}\leq\frac{L/2}{\gamma+t}(\frac{\delta^{2}B'}{\delta\mu-c+1}+(\gamma+1)\|w_{0}-w^{\ast}\|^{2})\\
	& \leq\frac{\kappa}{\gamma+t}(\frac{B'}{\mu}+4L\|w_{0}-w^{\ast}\|^{2})
	\end{align*}
	where $B'=8E^{2}L^{2}G^{2}/t+\frac{1}{N}\nu_{max}^{2}\sigma^{2}$. 
	
	With partial participation, the update at each communication round
	is now given by averages over a subset of sampled devices. The key
	is to bound 
	\begin{align*}
	\mathbb{E}\|\overline{w}_{t}-\overline{y}_{t}\|^{2} & =\frac{1}{K}\sum_{k}p^{k}\|w_{t}^{k}-\sum_{k}p_{k}w_{t}^{k}\|^{2}
	\end{align*}
	This can be bounded by the same argument as before and yield 
	\begin{align*}
	\mathbb{E}\|\overline{w}_{t}-\overline{y}_{t}\|^{2} & \leq\frac{4}{K}\alpha_{t}^{2}E^{2}G^{2}
	\end{align*}
	and so this is also a leading term, and together with the term $\alpha_{t}^{2}\frac{1}{N}\nu_{max}^{2}\sigma^{2}$
	determines the convergence rate, which is now $O(\frac{(\nu_{max}^{2}\sigma^{2}+4E^{2}G^{2})}{KT})$.
	This implies that $E$ canot be chosen $O(T^{\beta})$ for any $\beta>0$
	without degrading the performance. This should be checked in experiments,
	whether with partial participation if the communication round is set
	to scale with $T$, the convergence deteriorates. This is in constrast
	with the full participation case, where $E=O(\sqrt{\frac{T}{N}})$
	is allowed. \textbf{If we can confirm that full participation allows
		linear speedup with $\nu=N\cdot\max_{k}p_{k}\approx1$ and $E=O(\sqrt{\frac{T}{N}})$,
		whereas partial participation only allows $E=O(1)$, then this would
		an interesting phenomenon that is not reported by previous studies!}
\end{proof}