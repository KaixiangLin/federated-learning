
\subsection{Geometric Convergence of FedAvg for general strongly convex and smooth objectives}

\begin{thm}
	For the overparameterized setting with general strongly convex and
	smooth objectives, FedAvg with local SGD updates and communication
	every $E$ iterations with constant step size $\overline{\alpha}=\frac{1}{2E}\frac{N}{l\nu_{\max}+L(N-\nu_{\min})}$
	gives the exponential convergence guarantee 
	\begin{align*}
	\mathbb{E}F(\ov{w}_{t}) & \leq\frac{L}{2}(1-\mu\overline{\alpha})^{t}\|\vw_{0}-\vw^{\ast}\|^{2}=O(\exp(-\frac{\mu}{2E}\frac{N}{l\nu_{\max}+L(N-\nu_{\min})}t)\cdot\|\vw_{0}-\vw^{\ast}\|^{2})
	\end{align*}
\end{thm}
%
\begin{proof}
	To illustrate the main ideas of the proof, we first present the proof
	for $E=2$. Let $t-1$ be a communication round, so that $\vw_{t-1}^{k}=\ov{w}_{t-1}$.
	We show that 
	
	\begin{align*}
	\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq(1-\alpha_{t}\mu)(1-\alpha_{t-1}\mu)\|\ov{w}_{t-1}-\vw^{\ast}\|^{2}
	\end{align*}
	for appropriately chosen constant step sizes $\alpha_{t},\alpha_{t-1}$.
	We have 
	
	\begin{align*}
	\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & =\|(\ov{w}_{t}-\alpha_{t}\vg_{t})-\vw^{\ast}\|^{2}\\
	& =\|\ov{w}_{t}-\vw^{\ast}\|^{2}-2\alpha_{t}\langle\ov{w}_{t}-\vw^{\ast},\vg_{t}\rangle+\alpha_{t}^{2}\|\vg_{t}\|^{2}
	\end{align*}
	and the cross term can be bounded as usual using $\mu$-convexity
	and $L$-smoothness of $F_{k}$:
	\begin{align*}
	&-2\alpha_{t}\mathbb{E}_{t}\langle\ov{w}_{t}-\vw^{\ast},\vg_{t}\rangle\\
	& =-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle\ov{w}_{t}-\vw^{\ast},\nabla F_{k}(\vw_{t}^{k})\rangle\\
	& =-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle\ov{w}_{t}-\vw_{t}^{k},\nabla F_{k}(\vw_{t}^{k})\rangle-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle \vw_{t}^{k}-\vw^{\ast},\nabla F_{k}(\vw_{t}^{k})\rangle\\
	& \leq-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle\ov{w}_{t}-\vw_{t}^{k},\nabla F_{k}(\vw_{t}^{k})\rangle+2\alpha_{t}\sum_{k=1}^{N}p_{k}(F_{k}(\vw^{\ast})-F_{k}(\vw_{t}^{k}))-\alpha_{t}\mu\sum_{k=1}^{N}p_{k}\|\vw_{t}^{k}-\vw^{\ast}\|^{2}\\
	& \leq2\alpha_{t}\sum_{k=1}^{N}p_{k}\left[F_{k}(\vw_{t}^{k})-F_{k}(\ov{w}_{t})+\frac{L}{2}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}+F_{k}(\vw^{\ast})-F_{k}(\vw_{t}^{k})\right]-\alpha_{t}\mu\|\sum_{k=1}^{N}p_{k}(\vw_{t}^{k}-\vw^{\ast})\|^{2}\\
	& =\alpha_{t}L\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}+2\alpha_{t}\sum_{k=1}^{N}p_{k}\left[F_{k}(\vw^{\ast})-F_{k}(\ov{w}_{t})\right]-\alpha_{t}\mu\|\ov{w}_{t}-\vw^{\ast}\|^{2}\\
	& =\alpha_{t}L\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}-2\alpha_{t}\sum_{k=1}^{N}p_{k}F_{k}(\ov{w}_{t})-\alpha_{t}\mu\|\ov{w}_{t}-\vw^{\ast}\|^{2}
	\end{align*}
	and so 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq\mathbb{E}(1-\alpha_{t}\mu)\|\ov{w}_{t}-\vw^{\ast}\|^{2}-2\alpha_{t}F(\ov{w}_{t})+\alpha_{t}^{2}\|\vg_{t}\|^{2}+\alpha_{t}L\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}
	\end{align*}
	
	Applying this recursive relation to $\|\ov{w}_{t}-\vw^{\ast}\|^{2}$
	and using $\|\ov{w}_{t-1}-\vw_{t-1}^{k}\|^{2}\equiv0$, we further
	obtain 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq\mathbb{E}(1-\alpha_{t}\mu)\left((1-\alpha_{t-1}\mu)\|\ov{w}_{t-1}-\vw^{\ast}\|^{2}-2\alpha_{t-1}F(\ov{w}_{t-1})+\alpha_{t-1}^{2}\|\vg_{t-1}\|^{2}\right)\\
	& -2\alpha_{t}F(\ov{w}_{t})+\alpha_{t}^{2}\|\vg_{t}\|^{2}+\alpha_{t}L\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}
	\end{align*}
	Now instead of bounding $\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}$
	using the arguments in the general convex case, we use the fact that
	in the overparameterized setting, $\vw^{\ast}$ is a minimizer of each
	$\ell(\vw,x_{k}^{j})$ and that each $\ell$ is $l$-smooth to obtain
	$\|\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2}\leq2l(F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})-F_{k}(\vw^{\ast},\xi_{t-1}^{k}))$,
	where recall $F_{k}(\vw,\xi_{t-1}^{k})=\ell(\vw,\xi_{t-1}^{k})$, so that
	\begin{align*}
	\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2} & =\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\alpha_{t-1}\vg_{t-1}-\vw_{t-1}^{k}+\alpha_{t-1}\vg_{t-1,k}\|^{2}\\
	& =\sum_{k=1}^{N}p_{k}\alpha_{t-1}^{2}\|\vg_{t-1}-\vg_{t-1,k}\|^{2}\\
	& =\alpha_{t-1}^{2}\sum_{k=1}^{N}p_{k}(\|\vg_{t-1,k}\|^{2}-\|\vg_{t-1}\|^{2})\\
	& =\alpha_{t-1}^{2}\sum_{k=1}^{N}p_{k}\|\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2}-\alpha_{t-1}^{2}\|\vg_{t-1}\|^{2}\\
	& \le\alpha_{t-1}^{2}\sum_{k=1}^{N}p_{k}2l(F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})-F_{k}(\vw^{\ast},\xi_{t-1}^{k}))-\alpha_{t-1}^{2}\|\vg_{t-1}\|^{2}
	\end{align*}
	\begin{comment}
	(In the Nesterov case)
	\begin{align*}
	\mathbf{v}_{t+1}^{k} & =\mathbf{w}_{t}^{k}-\alpha_{t}\mathbf{g}_{t,k}\\
	\mathbf{w}_{t+1}^{k} & =\begin{cases}
	\mathbf{v}_{t+1}^{k}+\beta_{t}(\mathbf{v}_{t+1}^{k}-\mathbf{v}_{t}^{k}) & \text{if }t+1\notin\mathcal{I}_{E}\\
	\sum_{k=1}^{N}p_{k}\left[\mathbf{v}_{t+1}^{k}+\beta_{t}(\mathbf{v}_{t+1}^{k}-\mathbf{v}_{t}^{k})\right] & \text{if }t+1\in\mathcal{I}_{E}
	\end{cases}
	\end{align*}
	\begin{align*}
	\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2} & =\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\alpha_{t-1}\vg_{t-1}+\beta_{t-1}(\ov{v}_{t}-\ov{v}_{t-1})-\ov{w}_{t-1}+\alpha_{t-1}\vg_{t-1,k}-\beta_{t-1}(v_{t}-\ov{v}_{t-1})\|^{2}\\
	& =\sum_{k=1}^{N}p_{k}\|-\alpha_{t-1}\vg_{t-1}+\alpha_{t-1}\vg_{t-1,k}+\beta_{t-1}(\ov{v}_{t}-v_{t})\|^{2}\\
	& =\sum_{k=1}^{N}p_{k}\|-\alpha_{t-1}\vg_{t-1}+\alpha_{t-1}\vg_{t-1,k}+\beta_{t-1}(\ov{w}_{t-1}-\alpha_{t-1}\vg_{t-1}-\ov{w}_{t-1}-\alpha_{t-1}\vg_{t-1,k})\|^{2}\\
	& =\alpha_{t-1}^{2}(1+\beta_{t-1})^{2}\sum_{k=1}^{N}p_{k}\|\vg_{t-1}-\vg_{t-1,k}\|^{2}
	\end{align*}
	\end{comment}
	again using $\ov{w}_{t-1}=\vw_{t-1}^{k}$. Taking expectation
	with respect to $\xi_{t-1}^{k}$'s and using the fact that $F(\vw^{\ast})=0$,
	we have 
	\begin{align*}
	\mathbb{E}_{t-1}\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2} & \leq2l\alpha_{t-1}^{2}\sum_{k=1}^{N}p_{k}F_{k}(\ov{w}_{t-1})-\alpha_{t-1}^{2}\|\vg_{t-1}\|^{2}\\
	& =2l\alpha_{t-1}^{2}F(\ov{w}_{t-1})-\alpha_{t-1}^{2}\|\vg_{t-1}\|^{2}
	\end{align*}
	
	Note also that 
	\begin{align*}
	\|\vg_{t-1}\|^{2} & =\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2}
	\end{align*}
	while
	\begin{align*}
	\|\vg_{t}\|^{2}=\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\vw_{t}^{k},\xi_{t}^{k})\|^{2} & \leq2\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2}+2\|\sum_{k=1}^{N}p_{k}(\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})-\nabla F_{k}(\vw_{t}^{k},\xi_{t}^{k}))\|^{2}\\
	& \leq2\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2}+2\sum_{k=1}^{N}p_{k}l^{2}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}
	\end{align*}
	Substituting these into the bound for $\|\ov{w}_{t+1}-\vw^{\ast}\|^{2}$,
	we have 
	
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq\mathbb{E}(1-\alpha_{t}\mu)((1-\alpha_{t-1}\mu)\|\ov{w}_{t-1}-\vw^{\ast}\|^{2}-2\alpha_{t-1}F(\ov{w}_{t-1})+\alpha_{t-1}^{2}\|\vg_{t-1}\|^{2})\\
	& -2\alpha_{t}F(\ov{w}_{t})+2\alpha_{t}^{2}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2}+\left(2l^{2}\alpha_{t-1}^{2}\alpha_{t}^{2}+\alpha_{t}\alpha_{t-1}^{2}L\right)\left(2lF(\ov{w}_{t-1})-\|\vg_{t-1}\|^{2}\right)\\
	& =\mathbb{E}(1-\alpha_{t}\mu)(1-\alpha_{t-1}\mu)\|\ov{w}_{t-1}-\vw^{\ast}\|^{2}\\
	& -2\alpha_{t}(F(\ov{w}_{t})-\alpha_{t}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2})\\
	& -2\alpha_{t-1}(1-\alpha_{t}\mu)\left((1-\frac{l\alpha_{t-1}(2l^{2}\alpha_{t}^{2}+\alpha_{t}L)}{1-\alpha_{t}\mu})F(\ov{w}_{t-1})-\frac{\alpha_{t-1}}{2}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2}\right)
	\end{align*}
	from which we can conclude that 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq(1-\alpha_{t}\mu)(1-\alpha_{t-1}\mu)\mathbb{E}\|\ov{w}_{t-1}-\vw^{\ast}\|^{2}
	\end{align*}
	if we can choose $\alpha_{t},\alpha_{t-1}$ to guarantee
	\begin{align*}
	\mathbb{E}(F(\ov{w}_{t})-\alpha_{t}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2}) & \geq0\\
	\mathbb{E}\left((1-\frac{l\alpha_{t-1}(2l^{2}\alpha_{t}^{2}+\alpha_{t}L)}{1-\alpha_{t}\mu})F(\ov{w}_{t-1})-\frac{\alpha_{t-1}}{2}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2}\right) & \geq0
	\end{align*}
	
	Note that 
	
	\begin{align*}
	\mathbb{E}_{t}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2} & =\mathbb{E}_{t}\langle\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k}),\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\rangle\\
	& =\sum_{k=1}^{N}p_{k}^{2}\mathbb{E}_{t}\|\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2}+\sum_{k=1}^{N}\sum_{j\neq k}p_{j}p_{k}\mathbb{E}_{t}\langle\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k}),\nabla F_{j}(\ov{w}_{t},\xi_{t}^{j})\rangle\\
	& =\sum_{k=1}^{N}p_{k}^{2}\mathbb{E}_{t}\|\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2}+\sum_{k=1}^{N}\sum_{j\neq k}p_{j}p_{k}\langle\nabla F_{k}(\ov{w}_{t}),\nabla F_{j}(\ov{w}_{t})\rangle\\
	& =\sum_{k=1}^{N}p_{k}^{2}\mathbb{E}_{t}\|\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2}+\sum_{k=1}^{N}\sum_{j=1}^{N}p_{j}p_{k}\langle\nabla F_{k}(\ov{w}_{t}),\nabla F_{j}(\ov{w}_{t})\rangle-\sum_{k=1}^{N}p_{k}^{2}\|\nabla F_{k}(\ov{w}_{t})\|^{2}\\
	& \leq\sum_{k=1}^{N}p_{k}^{2}\mathbb{E}_{t}\|\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2}+\|\sum_{k}p_{k}\nabla F_{k}(\ov{w}_{t})\|^{2}-\frac{1}{N}\nu_{\min}\|\sum_{k}p_{k}\nabla F_{k}(\ov{w}_{t})\|^{2}\\
	& =\sum_{k=1}^{N}p_{k}^{2}\mathbb{E}_{t}\|\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2}+(1-\frac{1}{N}\nu_{\min})\|\nabla F(\ov{w}_{t})\|^{2}
	\end{align*}
	and so if we let $\alpha_{t}=\min\{\frac{qN}{2l\nu_{\max}},\frac{1-q}{2L(1-\frac{1}{N}\nu_{\min})}\}$
	for a $q\in[0,1]$ to be optimized later, we have 
	
	\begin{align*}
	& \mathbb{E}_{t}(F(\ov{w}_{t})-\alpha_{t}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2})\\
	& \geq\mathbb{E}_{t}\sum_{k=1}^{N}p_{k}F_{k}(\ov{w}_{t})-\alpha_{t}\left[\sum_{k=1}^{N}p_{k}^{2}\mathbb{E}_{t}\|\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2}+(1-\frac{1}{N}\nu_{\min})\|\nabla F(\ov{w}_{t})\|^{2}\right]\\
	& \geq\mathbb{E}_{t}\sum_{k=1}^{N}p_{k}(qF_{k}(\ov{w}_{t},\xi_{t}^{k})-\alpha_{t}\frac{1}{N}\nu_{\max}\|\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2})+((1-q)F(\ov{w}_{t})-\alpha_{t}(1-\frac{1}{N}\nu_{\min})\|\nabla F(\ov{w}_{t})\|^{2})\\
	& \geq q\mathbb{E}_{t}\sum_{k=1}^{N}p_{k}(F_{k}(\ov{w}_{t},\xi_{t}^{k})-\frac{1}{2l}\|\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2})+(1-q)(F(\ov{w}_{t})-\frac{1}{2L}\|\nabla F(\ov{w}_{t})\|^{2})\\
	& \geq0
	\end{align*}
	again using $\vw^{\ast}$ optimizes $F_{k}(\vw,\xi_{t}^{k})$ with $F_{k}(\vw^{\ast},\xi_{t}^{k})=0$. 
	
	Maximizing $\alpha_{t}=\min\{\frac{qN}{2l\nu_{\max}},\frac{1-q}{2L(1-\frac{1}{N}\nu_{\min})}\}$
	over $q\in[0,1]$, we see that $q=\frac{l\nu_{\max}}{l\nu_{\max}+L(N-\nu_{\min})}$
	results in the fastest convergence, and this translates to $\alpha_{t}=\frac{1}{2}\frac{N}{l\nu_{\max}+L(N-\nu_{\min})}$.
	Next we claim that $\alpha_{t-1}=c\frac{1}{2}\frac{N}{l\nu_{\max}+L(N-\nu_{\min})}$
	also guarantees
	\begin{align*}
	\mathbb{E}(1-\frac{l\alpha_{t-1}(2l^{2}\alpha_{t}^{2}+\alpha_{t}L)}{1-\alpha_{t}\mu})F(\ov{w}_{t-1})-\frac{\alpha_{t-1}}{2}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2} & \geq0
	\end{align*}
	
	Note that by scaling $\alpha_{t-1}$ by a constant $c\leq1$ if necessary,
	we can guarantee $\frac{l\alpha_{t-1}(2l^{2}\alpha_{t}^{2}+\alpha_{t}L)}{1-\alpha_{t}\mu}\leq\frac{1}{2}$,
	and so the condition is equivalent to 
	\begin{align*}
	F(\ov{w}_{t-1})-\alpha_{t-1}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2} & \geq0
	\end{align*}
	which was shown to hold with $\alpha_{t-1}\leq\frac{1}{2}\frac{N}{l\nu_{\max}+L(N-\nu_{\min})}$. 
	
	For the proof of general $E\ge2$, we use the following two identities:
	\begin{align*}
	\|\vg_{t}\|^{2} & \leq2\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2}+2\sum_{k=1}^{N}p_{k}l^{2}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}\\
	\mathbb{E}\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2} & \leq\mathbb{E}2(1+2l^{2}\alpha_{t-1}^{2})\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\vw_{t-1}^{k}\|^{2}+8\alpha_{t-1}^{2}lF(\ov{w}_{t-1})-2\alpha_{t-1}^{2}\|\vg_{t-1}\|^{2}
	\end{align*}
	where the first inequality has been established before. To establish
	the second inequality, note that 
	\begin{align*}
	\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2} & =\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\alpha_{t-1}\vg_{t-1}-\vw_{t-1}^{k}+\alpha_{t-1}\vg_{t-1,k}\|^{2}\\
	& \leq2\sum_{k=1}^{N}p_{k}\left(\|\ov{w}_{t-1}-\vw_{t-1}^{k}\|^{2}+\|\alpha_{t-1}\vg_{t-1}-\alpha_{t-1}\vg_{t-1,k}\|^{2}\right)
	\end{align*}
	and
	\begin{align*}
	& \sum_{k}p_{k}\|\vg_{t-1,k}-\vg_{t-1}\|^{2}=\sum_{k}p_{k}(\|\vg_{t-1,k}\|^{2}-\|\vg_{t-1}\|^{2})\\
	& =\sum_{k}p_{k}\|\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})+\nabla F_{k}(\vw_{t-1}^{k},\xi_{t-1}^{k})-\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2}-\|\vg_{t-1}\|^{2}\\
	& \leq2\sum_{k}p_{k}\left(\|\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2}+l^{2}\|\vw_{t-1}^{k}-\ov{w}_{t-1}\|^{2}\right)-\|\vg_{t-1}\|^{2}
	\end{align*}
	so that using the $l$-smoothness of $\ell$, 
	\begin{align*}
	& \mathbb{E}\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}\\
	& \leq\mathbb{E}2(1+2l^{2}\alpha_{t-1}^{2})\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\vw_{t-1}^{k}\|^{2}+4\alpha_{t-1}^{2}\sum_{k}p_{k}\|\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2}-2\alpha_{t-1}^{2}\|\vg_{t-1}\|^{2}\\
	& \leq\mathbb{E}2(1+2l^{2}\alpha_{t-1}^{2})\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\vw_{t-1}^{k}\|^{2}+4\alpha_{t-1}^{2}2l\sum_{k}p_{k}(F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})-F_{k}(\vw^{\ast},\xi_{t-1}^{k}))-2\alpha_{t-1}^{2}\|\vg_{t-1}\|^{2}\\
	& =\mathbb{E}2(1+2l^{2}\alpha_{t-1}^{2})\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\vw_{t-1}^{k}\|^{2}+8\alpha_{t-1}^{2}lF(\ov{w}_{t-1})-2\alpha_{t-1}^{2}\|\vg_{t-1}\|^{2}
	\end{align*}
	
	
	Using the first inequality, we have 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq\mathbb{E}(1-\alpha_{t}\mu)\|\ov{w}_{t}-\vw^{\ast}\|^{2}\\
	& -2\alpha_{t}F(\ov{w}_{t})+2\alpha_{t}^{2}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2}\\
	& +(2\alpha_{t}^{2}l^{2}+\alpha_{t}L)\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}
	\end{align*}
	and we choose $\alpha_{t}$ and $\alpha_{t-1}$ such that $\mathbb{E}(F(\ov{w}_{t})-\alpha_{t}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t},\xi_{t}^{k})\|^{2})\geq0$
	and $(2\alpha_{t}^{2}l^{2}+\alpha_{t}L)\leq(1-\alpha_{t}\mu)(2\alpha_{t-1}^{2}l^{2}+\alpha_{t-1}L)/3$.
	This gives 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq\mathbb{E}(1-\alpha_{t}\mu)[(1-\alpha_{t-1}\mu)\|\ov{w}_{t-1}-\vw^{\ast}\|^{2}-2\alpha_{t-1}F(\ov{w}_{t-1})+2\alpha_{t-1}^{2}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2}\\
	& +(2\alpha_{t-1}^{2}l^{2}+\alpha_{t-1}L)(\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\vw_{t-1}^{k}\|^{2}+\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2})/3]
	\end{align*}
	
	Using the second inequality
	\begin{align*}
	\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2} & \leq\mathbb{E}2(1+2l^{2}\alpha_{t-1}^{2})\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\vw_{t-1}^{k}\|^{2}+8\alpha_{t-1}^{2}lF(\ov{w}_{t-1})-2\alpha_{t-1}^{2}\|\vg_{t-1}\|^{2}
	\end{align*}
	and that $2(1+2l^{2}\alpha_{t-1}^{2})\leq3$, $2\alpha_{t-1}^{2}l^{2}+\alpha_{t-1}L\le1$,
	we have 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq\mathbb{E}(1-\alpha_{t}\mu)[(1-\alpha_{t-1}\mu)\|\ov{w}_{t-1}-\vw^{\ast}\|^{2}\\
	& -2\alpha_{t-1}F(\ov{w}_{t-1})+2\alpha_{t-1}^{2}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2}+8\alpha_{t-1}^{2}lF(\ov{w}_{t-1})\\
	& +(2\alpha_{t-1}^{2}l^{2}+\alpha_{t-1}L)(2\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\vw_{t-1}^{k}\|^{2})]
	\end{align*}
	and if $\alpha_{t-1}$ is chosen such that 
	\begin{align*}
	(F(\ov{w}_{t-1})-4\alpha_{t-1}lF(\ov{w}_{t-1}))-\alpha_{t-1}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t-1},\xi_{t-1}^{k})\|^{2}\geq0
	\end{align*}
	and
	\begin{align*} (2\alpha_{t-1}^{2}l^{2}+\alpha_{t-1}L)(1-\alpha_{t-1}\mu)
	&\leq(2\alpha_{t-2}^{2}l^{2}+\alpha_{t-2}L)/3
	\end{align*}
	we again have 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq\mathbb{E}(1-\alpha_{t}\mu)(1-\alpha_{t-1}\mu)[\|\ov{w}_{t-1}-\vw^{\ast}\|^{2}+(2\alpha_{t-2}^{2}l^{2}+\alpha_{t-2}L)\cdot(2\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\vw_{t-1}^{k}\|^{2})/3]
	\end{align*}
	
	Applying the above derivation iteratively $\tau<E$ times, we have
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq\mathbb{E}(1-\alpha_{t}\mu)\cdots(1-\alpha_{t-\tau+1}\mu)[(1-\alpha_{t-\tau}\mu)\|\ov{w}_{t-\tau}-\vw^{\ast}\|^{2}\\
	& -2\alpha_{t-\tau}F(\ov{w}_{t-\tau})+2\alpha_{t-\tau}^{2}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t-\tau},\xi_{t-\tau}^{k})\|^{2}+8\tau\alpha_{t-\tau}^{2}lF(\ov{w}_{t-\tau})\\
	& +(2\alpha_{t-\tau}^{2}l^{2}+\alpha_{t-\tau}L)((\tau+1)\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-\tau}-\vw_{t-\tau}^{k}\|^{2})]
	\end{align*}
	as long as the step sizes $\alpha_{t-\tau}$ are chosen such that
	the following inequalities hold 
	\begin{align*}
	(2\alpha_{t-\tau}^{2}l^{2}+\alpha_{t-\tau}L)(1-\alpha_{t-\tau}\mu) & \leq(2\alpha_{t-\tau-1}^{2}l^{2}+\alpha_{t-\tau-1}L)/3\\
	2(1+2l^{2}\alpha_{t-\tau}^{2}) & \leq3\\
	2\alpha_{t-\tau}^{2}l^{2}+\alpha_{t-\tau}L & \leq1\\
	(F(\ov{w}_{t-\tau})-4\tau\alpha_{t-\tau}lF(\ov{w}_{t-\tau}))-\alpha_{t-\tau}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t-\tau},\xi_{t-\tau}^{k})\|^{2} & \geq0
	\end{align*}
	We can check that setting $\alpha_{t-\tau}=c\frac{1}{\tau+1}\frac{N}{l\nu_{\max}+L(N-\nu_{\min})}$
	for some small constant $c$ satisfies the requirements. 
	
	Since communication is done every $E$ iterations, $\ov{w}_{t_{0}}=\vw_{t_{0}}^{k}$
	for some $t_{0}>t-E$ , from which we can conclude that 
	
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t}-\vw^{\ast}\|^{2} & \leq(\prod_{\tau=1}^{t-t_{0}-1}(1-\mu\alpha_{t-\tau}))\|\vw_{t_{0}}-\vw^{\ast}\|^{2}\\
	& \leq(1-c\frac{\mu}{E}\frac{N}{l\nu_{\max}+L(N-\nu_{\min})})^{t-t_{0}}\|\vw_{t_{0}}-\vw^{\ast}\|^{2}
	\end{align*}
	and applying this inequality to iterations between each communication
	round, 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t}-\vw^{\ast}\|^{2} & \leq(1-c\frac{\mu}{E}\frac{N}{l\nu_{\max}+L(N-\nu_{\min})})^{t}\|\vw_{0}-\vw^{\ast}\|^{2}\\
	& =O(\exp(\frac{\mu}{E}\frac{N}{l\nu_{\max}+L(N-\nu_{\min})}t))\|\vw_{0}-\vw^{\ast}\|^{2}
	\end{align*}
	
	With partial participation, we note that 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & =\mathbb{E}\|\ov{w}_{t+1}-\ov{v}_{t+1}+\ov{v}_{t+1}-\vw^{\ast}\|^{2}\\
	& =\mathbb{E}\|\ov{w}_{t+1}-\ov{v}_{t+1}\|^{2}+\mathbb{E}\|\ov{v}_{t+1}-\vw^{\ast}\|^{2}\\
	& =\frac{1}{K}\sum_{k}p_{k}\mathbb{E}\|\vw_{t+1}^{k}-\ov{w}_{t+1}\|^{2}+\mathbb{E}\|\ov{v}_{t+1}-\vw^{\ast}\|^{2}
	\end{align*}
	and so the recursive identity becomes 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq\mathbb{E}(1-\alpha_{t}\mu)\cdots(1-\alpha_{t-\tau+1}\mu)[(1-\alpha_{t-\tau}\mu)\|\ov{w}_{t-\tau}-\vw^{\ast}\|^{2}\\
	& -2\alpha_{t-\tau}F(\ov{w}_{t-\tau})+2\alpha_{t-\tau}^{2}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t-\tau},\xi_{t-\tau}^{k})\|^{2}+8\tau\alpha_{t-\tau}^{2}lF(\ov{w}_{t-\tau})\\
	& +(2\alpha_{t-\tau}^{2}l^{2}+\alpha_{t-\tau}L+\frac{1}{K})((\tau+1)\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-\tau}-\vw_{t-\tau}^{k}\|^{2})]
	\end{align*}
	which requires 
	\begin{align*}
	(2\alpha_{t-\tau}^{2}l^{2}+\alpha_{t-\tau}L+\frac{1}{K})(1-\alpha_{t-\tau}\mu) & \leq(2\alpha_{t-\tau-1}^{2}l^{2}+\alpha_{t-\tau-1}L+\frac{1}{K})/3\\
	2(1+2l^{2}\alpha_{t-\tau}^{2}) & \leq3\\
	2\alpha_{t-\tau}^{2}l^{2}+\alpha_{t-\tau}L+\frac{1}{K} & \leq1\\
	(F(\ov{w}_{t-\tau})-4\tau\alpha_{t-\tau}lF(\ov{w}_{t-\tau}))-\alpha_{t-\tau}\|\sum_{k=1}^{N}p_{k}\nabla F_{k}(\ov{w}_{t-\tau},\xi_{t-\tau}^{k})\|^{2} & \geq0
	\end{align*}
	to hold. Again setting $\alpha_{t-\tau}=c\frac{1}{\tau+1}\frac{N}{l\nu_{\max}+L(N-\nu_{\min})}$
	for a possibly different constant from before satisfies the requirements.
	
	Finally, using the $L$-smoothness of $F$, 
	\begin{align*}
	F(\ov{w}_{T})-F(\vw^{\ast}) & \leq\frac{L}{2}\mathbb{E}\|\ov{w}_{T}-\vw^{\ast}\|^{2}=O(L\exp(-\frac{\mu}{E}\frac{N}{l\nu_{\max}+L(N-\nu_{\min})}T))\|\vw_{0}-\vw^{\ast}\|^{2}
	\end{align*}
\end{proof}

\subsection{Geometric Convergence of FedAvg for Overparameterized Linear Regression}

We first provide details on quantities used in the proof of results on linear regression in Section~\ref{sec:overparameterized} in the main text. The local device objectives are now given by the sum of squares {\small$F_{k}(\mathbf{w})=\frac{1}{2n_{k}}\sum_{j=1}^{n_{k}}(\mathbf{w}^{T}\mathbf{x}_{k}^{j}-\vz_{k}^{j})^{2}$},
and there exists $\mathbf{w}^{\ast}$ such that $F(\mathbf{w}^{\ast})\equiv0$. 
Define the local Hessian matrix as $\vH^{k}:=\frac{1}{n_{k}}\sum_{j=1}^{n_{k}}\mathbf{x}_{k}^{j}(\mathbf{x}_{k}^{j})^{T}$, and the stochastic Hessian matrix as $\tilde{\vH}_{t}^{k}:=\xi_{t}^{k}(\xi_{t}^{k})^{T}$, where $\xi_{t}^{k}$ is the stochastic sample on the $k$th device at
time $t$. Define $l$ to be the smallest positive number such that $\mathbb{E}\|\xi_{t}^{k}\|^{2}$$\mathbf{\xi}_{t}^{k}$($\mathbf{\xi}_{t}^{k})^{T}\preceq l\vH^{k}$ for all $k$. Note that $l\leq\max_{k,j}\|\mathbf{x}_{k}^{j}\|^{2}$.
Let $L$ and $\mu$ be lower and upper bounds of non-zero eigenvalues
of $\vH^{k}$. Define $\kappa_{1}:=l/\mu$ and $\kappa:=L/\mu$. 

Following
\cite{liu2018accelerating,jain2017accelerating}, we define the statistical
condition number $\tilde{\kappa}$ as the smallest positive real number
such that $\mathbb{E}\sum_{k}p_{k}\tilde{H}_{t}^{k}H^{-1}\tilde{H}_{t}^{k}\leq\tilde{\kappa}H$. 
The condition numbers $\kappa_{1}$ and $\tilde{\kappa}$
are important in the characterization of convergence rates for FedAvg
algorithms. Note that $\kappa_{1}>\kappa$ and $\kappa_{1}>\tilde{\kappa}$.


Let $\vH=\sum_{k}p_k\vH^k$. In general $\vH$ has zero eigenvalues. However, because the null space
of $\vH$ and range of $\vH$ are orthogonal, in our subsequence analysis
it suffices to project $\overline{\mathbf{w}}_{t}-\mathbf{w}^{\ast}$
onto the range of $\vH$, thus we may restrict to the non-zero eigenvalue
of $\vH$. 

A useful observation is that we can use $\mathbf{w}^{\ast T}\mathbf{x}_{k}^{j}-\vz_{k}^{j}\equiv0$
to rewrite the local objectives as $F_{k}(\mathbf{w})=\frac{1}{2}\langle\mathbf{w}-\mathbf{w}^{\ast},\vH^{k}(\mathbf{w}-\mathbf{w}^{\ast})\rangle\equiv\frac{1}{2}\|\mathbf{w}-\mathbf{w}^{\ast}\|_{\vH^{k}}^{2}$:
\begin{align*}
F_{k}(\vw) & =\frac{1}{2n_{k}}\sum_{j=1}^{n_{k}}(\vw^{T}x_{k,j}-\vz_{k,j}-(\vw^{\ast T}\vx_{k,j}-\vz_{k,j}))^{2}=\frac{1}{2n_{k}}\sum_{j=1}^{n_{k}}((\vw-\vw^{\ast})^{T}\vx_{k,j})^{2}\\
& =\frac{1}{2}\langle \vw-\vw^{\ast},\vH^{k}(\vw-\vw^{\ast})\rangle=\frac{1}{2}\|w-\vw^{\ast}\|_{\vH^{k}}^{2}
\end{align*}

so that $F(\mathbf{w})=\frac{1}{2}\|\mathbf{w}-\mathbf{w}^{\ast}\|_{H}^{2}$.

Finally, note that $\mathbb{E}\tilde{\vH}_{t}^{k}=\frac{1}{n_{k}}\sum_{j=1}^{n_{k}}\mathbf{x}_{k}^{j}(\mathbf{x}_{k}^{j})^{T}=\vH^{k}$
and $\mathbf{g}_{t,k}=\nabla F_{k}(\mathbf{w}_{t}^{k},\xi_{t}^{k})=\tilde{\vH}_{t}^{k}(\mathbf{w}_{t}^{k}-\mathbf{w}^{\ast})$
while $\mathbf{g}_{t}=\sum_{k=1}^{N}p_{k}\nabla F_{k}(\mathbf{w}_{t}^{k},\xi_{t}^{k})=\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\mathbf{w}_{t}^{k}-\mathbf{w}^{\ast})$ and $\overline{\mathbf{g}}_{t}=\sum_{k=1}^{N}p_{k}\vH^{k}(\mathbf{w}_{t}^{k}-\mathbf{w}^{\ast})$ 
\\
	\begin{thm}
		For the overparamterized linear regression problem, FedAvg with communication every $E$
		iterations with constant step size $\overline{\alpha}=\mathcal{O}(\frac{1}{E}\frac{N}{l\nu_{\max}+\mu(N-\nu_{\min})})$
		has geometric convergence:
		\begin{align*}
		\mathbb{E}F(\overline{\mathbf{w}}_{T}) & \leq\mathcal{O}\left(L\exp(-\frac{NT}{E(\nu_{\max}\kappa_{1}+(N-\nu_{\min}))})\|\mathbf{w}_{0}-\mathbf{w}^{\ast}\|^{2}\right).
		\end{align*}
	\end{thm}
	% 
\begin{proof}
	We again show the result first when $E=2$ and $t-1$ is a communication
	round. We have 
	\begin{align*}
	\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & =\|(\ov{w}_{t}-\alpha_{t}\vg_{t})-\vw^{\ast}\|^{2}\\
	& =\|\ov{w}_{t}-\vw^{\ast}\|^{2}-2\alpha_{t}\langle\ov{w}_{t}-\vw^{\ast},\vg_{t}\rangle+\alpha_{t}^{2}\|\vg_{t}\|^{2}
	\end{align*}
	and 
	\begin{align*}
	& -2\alpha_{t}\mathbb{E}_{t}\langle\ov{w}_{t}-\vw^{\ast},\vg_{t}\rangle\\
	& =-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle\ov{w}_{t}-\vw^{\ast},\nabla F_{k}(\vw_{t}^{k})\rangle\\
	& =-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle\ov{w}_{t}-\vw_{t}^{k},\nabla F_{k}(\vw_{t}^{k})\rangle-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle \vw_{t}^{k}-\vw^{\ast},\nabla F_{k}(\vw_{t}^{k})\rangle\\
	& =-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle\ov{w}_{t}-\vw_{t}^{k},\nabla F_{k}(\vw_{t}^{k})\rangle-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle \vw_{t}^{k}-\vw^{\ast},\vH^{k}(\vw_{t}^{k}-\vw^{\ast})\rangle\\
	& =-2\alpha_{t}\sum_{k=1}^{N}p_{k}\langle\ov{w}_{t}-\vw_{t}^{k},\nabla F_{k}(\vw_{t}^{k})\rangle-4\alpha_{t}\sum_{k=1}^{N}p_{k}F_{k}(\vw_{t}^{k})\\
	& \leq2\alpha_{t}\sum_{k=1}^{N}p_{k}(F_{k}(\vw_{t}^{k})-F_{k}(\ov{w}_{t})+\frac{L}{2}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2})-4\alpha_{t}\sum_{k=1}^{N}p_{k}F_{k}(\vw_{t}^{k})\\
	& =\alpha_{t}L\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}-2\alpha_{t}\sum_{k=1}^{N}p_{k}F_{k}(\ov{w}_{t})-2\alpha_{t}\sum_{k=1}^{N}p_{k}F_{k}(\vw_{t}^{k})\\
	& =\alpha_{t}L\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}-\alpha_{t}\sum_{k=1}^{N}p_{k}\langle(\ov{w}_{t}-\vw^{\ast}),\vH^{k}(\ov{w}_{t}-\vw^{\ast})\rangle-2\alpha_{t}\sum_{k=1}^{N}p_{k}F_{k}(\vw_{t}^{k})
	\end{align*}
	and 
	\begin{align*}
	\|\vg_{t}\|^{2} & =\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\vw_{t}^{k}-\vw^{\ast})\|^{2}\\
	& =\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})+\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\vw_{t}^{k}-\ov{w}_{t})\|^{2}\\
	& \leq2\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}+2\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\vw_{t}^{k}-\ov{w}_{t})\|^{2}
	\end{align*}
	which gives 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq\mathbb{E}\|\ov{w}_{t}-\vw^{\ast}\|^{2}-\alpha_{t}\sum_{k=1}^{N}p_{k}\langle\ov{w}_{t}-\vw^{\ast},\vH^{k}\ov{w}_{t}-\vw^{\ast}\rangle+2\alpha_{t}^{2}\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}\\
	& +\alpha_{t}L\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}+2\alpha_{t}^{2}\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\vw_{t}^{k}-\ov{w}_{t})\|^{2}-2\alpha_{t}\sum_{k=1}^{N}p_{k}F_{k}(\vw_{t}^{k})
	\end{align*}
	we first prove that 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t}-\vw^{\ast}\|^{2}-\alpha_{t}\sum_{k=1}^{N}p_{k}\langle(\ov{w}_{t}-\vw^{\ast}),\vH^{k}(\ov{w}_{t}-\vw^{\ast})\rangle+2\alpha_{t}^{2}\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}\\
	\leq(1-\frac{N}{8(\nu_{\max}\kappa_{1}+(N-\nu_{\min}))})\mathbb{E}\|\ov{w}_{t}-\vw^{\ast}\|^{2}
	\end{align*}
	with appropriately chosen $\alpha_{t}$. Compared to the rate $O(\frac{\mu N}{l\nu_{\max}+L(N-\nu_{\min})})=O(\frac{N}{\nu_{\max}\kappa_{1}+(N-\nu_{\min})\kappa})$
	for general strongly convex and smooth objectives, this is an improvement
	as linear speedup is now available for a larger range of $N$. 
	
	We have 
	\begin{align*}
	& \mathbb{E}_{t}\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}\\
	& =\mathbb{E}_{t}\langle\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast}),\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\rangle\\
	& =\sum_{k=1}^{N}p_{k}^{2}\mathbb{E}_{t}\|\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}+\sum_{k=1}^{N}\sum_{j\neq k}p_{j}p_{k}\mathbb{E}_{t}\langle\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast}),\tilde{\vH}_{t}^{j}(\ov{w}_{t}-\vw^{\ast})\rangle\\
	& =\sum_{k=1}^{N}p_{k}^{2}\mathbb{E}_{t}\|\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}+\sum_{k=1}^{N}\sum_{j\neq k}p_{j}p_{k}\mathbb{E}_{t}\langle \vH^{k}(\ov{w}_{t}-\vw^{\ast}),\vH^{j}(\ov{w}_{t}-\vw^{\ast})\rangle\\
	& =\sum_{k=1}^{N}p_{k}^{2}\mathbb{E}_{t}\|\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}+\sum_{k=1}^{N}\sum_{j=1}^{N}p_{j}p_{k}\mathbb{E}_{t}\langle \vH^{k}(\ov{w}_{t}-\vw^{\ast}),\vH^{j}(\ov{w}_{t}-\vw^{\ast})\rangle-\sum_{k=1}^{N}p_{k}^{2}\|\vH^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}\\
	& =\sum_{k=1}^{N}p_{k}^{2}\mathbb{E}_{t}\|\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}+\|\sum_{k}p_{k}\vH^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}-\sum_{k=1}^{N}p_{k}^{2}\|\vH^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}\\
	& \leq\sum_{k=1}^{N}p_{k}^{2}\mathbb{E}_{t}\|\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}+\|\sum_{k}p_{k}\vH^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}-\frac{1}{N}\nu_{\min}\|\sum_{k}p_{k}\vH^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}\\
	& \leq\frac{1}{N}\nu_{\max}\sum_{k=1}^{N}p_{k}\mathbb{E}_{t}\|\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}+(1-\frac{1}{N}\nu_{\min})\|\sum_{k}p_{k}\vH^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}\\
	& \leq\frac{1}{N}\nu_{\max}l\sum_{k=1}^{N}p_{k}\langle(\ov{w}_{t}-\vw^{\ast}),\vH^{k}(\ov{w}_{t}-\vw^{\ast})\rangle+(1-\frac{1}{N}\nu_{\min})\|\sum_{k}p_{k}\vH^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}\\
	& =\frac{1}{N}\nu_{\max}l\langle(\ov{w}_{t}-\vw^{\ast}),\vH(\ov{w}_{t}-\vw^{\ast})\rangle+(1-\frac{1}{N}\nu_{\min})\langle\ov{w}_{t}-\vw^{\ast},\vH^{2}(\ov{w}_{t}-\vw^{\ast})\rangle
	\end{align*}
	using $\|\tilde{\vH}_{t}^{k}\|\leq l$. 
	
	Now we have 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t}-\vw^{\ast}\|^{2}-\alpha_{t}\sum_{k=1}^{N}p_{k}\langle(\ov{w}_{t}-\vw^{\ast}),\vH^{k}(\ov{w}_{t}-\vw^{\ast})\rangle+2\alpha_{t}^{2}\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2} & =\\
	\langle\ov{w}_{t}-\vw^{\ast},(I-\alpha_{t}\vH+2\alpha_{t}^{2}(\frac{\nu_{\max}l}{N}\vH+\frac{N-\nu_{\min}}{N}\vH^{2}))(\ov{w}_{t}-\vw^{\ast})\rangle
	\end{align*}
	and it remains to bound the maximum eigenvalue of 
	\begin{align*}
	(I-\alpha_{t}\vH+2\alpha_{t}^{2}(\frac{\nu_{\max}l}{N}\vH+\frac{N-\nu_{\min}}{N}\vH^{2}))
	\end{align*}
	
	If we choose $\alpha_{t}<\frac{N}{2(\nu_{\max}l+(N-\nu_{\min})L)}$,
	then 
	\begin{align*}
	-\alpha_{t}\vH+2\alpha_{t}^{2}(\frac{\nu_{\max}l}{N}\vH+\frac{N-\nu_{\min}}{N}\vH^{2}) & \prec0
	\end{align*}
	and the convergence rate is given by the maximum of $1-\alpha_{t}\lambda+2\alpha_{t}^{2}(\frac{\nu_{\max}l}{N}\lambda+\frac{N-\nu_{\min}}{N}\lambda^{2})$
	maximized over the non-zero eigenvalues $\lambda$ of $\vH$. To select
	the step size $\alpha_{t}$ that gives the smallest upper bound, we
	then minimize over $\alpha_{t}$, resulting in 
	\begin{align*}
	\min_{\alpha_{t}<\frac{N}{2(\nu_{\max}l+(N-\nu_{\min})L)}}\max_{\lambda>0:\exists v,\vH v=\lambda v}\left\{ 1-\alpha_{t}\lambda+2\alpha_{t}^{2}(\frac{\nu_{\max}l}{N}\lambda+\frac{N-\nu_{\min}}{N}\lambda^{2})\right\} 
	\end{align*}
	Since the objective is quadratic in $\lambda$, the maximum is achieved
	at either the largest eigenvalue $\lambda_{\max}$ of $\vH$ or the
	smallest non-zero eigenvalue $\lambda_{\min}$ of $\vH$. 
	
	When $N\leq\frac{4\nu_{\max}l}{L-\lambda_{\min}}+4\nu_{\min}$, i.e.
	when $N=O(l/\lambda_{\min})=O(\kappa_{1})$, the optimal objective
	value is achieved at $\lambda_{\min}$ and the optimal step size is
	given by $\alpha_{t}=\frac{N}{4(\nu_{\max}l+(N-\nu_{\min})\lambda_{\min})}$.
	The optimal convergence rate (i.e. the optimal objective value) is
	equal to $1-\frac{1}{8}\frac{N\lambda_{\min}}{(\nu_{\max}l+(N-\nu_{\min})\lambda_{\min})}=1-\frac{1}{8}\frac{N}{(\nu_{\max}\kappa_{1}+(N-\nu_{\min}))}$.
	This implies that when $N=O(\kappa_{1})$, the optimal convergence
	rate has a linear speedup in $N$. When $N$ is larger, this step
	size is no longer optimal, but we still have $1-\frac{1}{8}\frac{N}{(\nu_{\max}\kappa_{1}+(N-\nu_{\min}))}$
	as an upper bound on the convergence rate. 
	
	Now we have proved 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq(1-\frac{1}{8}\frac{N}{(\nu_{\max}\kappa_{1}+(N-\nu_{\min}))})\mathbb{E}\|\ov{w}_{t}-\vw^{\ast}\|^{2}\\
	& +\alpha_{t}L\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}+2\alpha_{t}^{2}\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\vw_{t}^{k}-\ov{w}_{t})\|^{2}-2\alpha_{t}\sum_{k=1}^{N}p_{k}F_{k}(\vw_{t}^{k})
	\end{align*}
	Next we bound terms in the second line using a similar argument as
	the general case. We have 
	\begin{align*}
	2\alpha_{t}^{2}\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\vw_{t}^{k}-\ov{w}_{t})\|^{2} & \leq2\alpha_{t}^{2}l^{2}\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2}
	\end{align*}
	and 
	\begin{align*}
	\mathbb{E}\sum_{k=1}^{N}p_{k}\|\ov{w}_{t}-\vw_{t}^{k}\|^{2} & \leq\mathbb{E}2(1+2l^{2}\alpha_{t-1}^{2})\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\vw_{t-1}^{k}\|^{2}+8\alpha_{t-1}^{2}lF(\ov{w}_{t-1})\\
	& =4\alpha_{t-1}^{2}l\langle\ov{w}_{t-1}-\vw^{\ast},\vH(\ov{w}_{t-1}-\vw^{\ast})\rangle
	\end{align*}
	and if $\alpha_{t},\alpha_{t-1}$ satisfy 
	\begin{align*}
	\alpha_{t}L+2\alpha_{t}^{2} & \leq(1-\frac{1}{8}\frac{N}{(\nu_{\max}\kappa_{1}+(N-\nu_{\min}))})(\alpha_{t-1}L+2\alpha_{t-1}^{2})/3\\
	2(1+2l^{2}\alpha_{t-1}^{2}) & \leq3\\
	\alpha_{t}L+2\alpha_{t}^{2} & \leq1
	\end{align*}
	we have 
	\begin{align*}
	& \mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2}\\
	& \leq(1-\frac{1}{8}\frac{N}{(\nu_{\max}\kappa_{1}+(N-\nu_{\min}))})[\mathbb{E}\|\ov{w}_{t-1}-\vw^{\ast}\|^{2}-\alpha_{t}\langle\ov{w}_{t-1}-\vw^{\ast},\vH\ov{w}_{t-1}-\vw^{\ast}\rangle+2\alpha_{t}^{2}\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t}^{k}(\ov{w}_{t}-\vw^{\ast})\|^{2}\\
	& +(\alpha_{t-1}L+2\alpha_{t-1}^{2})\cdot2\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-1}-\vw_{t-1}^{k}\|^{2}+4\alpha_{t-1}^{2}l\langle\ov{w}_{t-1}-\vw^{\ast},\vH(\ov{w}_{t-1}-\vw^{\ast})\rangle]
	\end{align*}
	and again by choosing $\alpha_{t-1}=c\frac{N}{8(\nu_{\max}l+(N-\nu_{\min})\lambda_{\min})}$
	for a small constant $c$, we can guarantee that 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t-1}-\vw^{\ast}\|^{2}-\alpha_{t-1}\langle\ov{w}_{t-1}-\vw^{\ast},\vH\ov{w}_{t-1}-\vw^{\ast}\rangle\\
	+2\alpha_{t-1}^{2}\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t-1}^{k}(\ov{w}_{t-1}-\vw^{\ast})\|^{2}+4\alpha_{t-1}^{2}l\langle\ov{w}_{t-1}-\vw^{\ast},\vH(\ov{w}_{t-1}-\vw^{\ast})\rangle\\
	\leq(1-c\frac{N}{16(\nu_{\max}l+(N-\nu_{\min})\lambda_{\min})})\mathbb{E}\|\ov{w}_{t-1}-\vw^{\ast}\|^{2}
	\end{align*}
	
	For general $E$, we have the recursive relation
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t+1}-\vw^{\ast}\|^{2} & \leq\mathbb{E}(1-c\frac{1}{8}\frac{N}{(\nu_{\max}\kappa_{1}+(N-\nu_{\min}))})\cdots(1-c\frac{1}{8\tau}\frac{N}{(\nu_{\max}\kappa_{1}+(N-\nu_{\min}))})[\|\ov{w}_{t-\tau}-\vw^{\ast}\|^{2}\\
	& -\alpha_{t-\tau}\langle\ov{w}_{t-\tau}-\vw^{\ast},\vH\ov{w}_{t-\tau}-\vw^{\ast}\rangle+2\alpha_{t-\tau}^{2}\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t-\tau}^{k}(\ov{w}_{t-\tau}-\vw^{\ast})\|^{2}\\
	& +4\tau\alpha_{t-1}^{2}l\langle\ov{w}_{t-1}-\vw^{\ast},\vH(\ov{w}_{t-1}-\vw^{\ast})\rangle\\
	& +(2\alpha_{t-\tau}^{2}l^{2}+\alpha_{t-\tau}L)((\tau+1)\sum_{k=1}^{N}p_{k}\|\ov{w}_{t-\tau}-\vw_{t-\tau}^{k}\|^{2})]
	\end{align*}
	as long as the step sizes are chosen $\alpha_{t-\tau}=c\frac{N}{4\tau(\nu_{\max}l+(N-\nu_{\min})\lambda_{\min})}$
	such that the following inequalities hold 
	\begin{align*}
	(2\alpha_{t-\tau}^{2}l^{2}+\alpha_{t-\tau}L) & \leq(1-\alpha_{t-\tau}\mu)(2\alpha_{t-\tau-1}^{2}l^{2}+\alpha_{t-\tau-1}L)/3\\
	2(1+2l^{2}\alpha_{t-\tau}^{2}) & \leq3\\
	2\alpha_{t-\tau}^{2}l^{2}+\alpha_{t-\tau}L & \leq1
	\end{align*}
	and 
	\begin{align*}
	& \|\ov{w}_{t-\tau}-\vw^{\ast}\|^{2}-\alpha_{t-\tau}\langle\ov{w}_{t-\tau}-\vw^{\ast},\vH\ov{w}_{t-\tau}-\vw^{\ast}\rangle\\
	& +2\alpha_{t-\tau}^{2}\|\sum_{k=1}^{N}p_{k}\tilde{\vH}_{t-\tau}^{k}(\ov{w}_{t-\tau}-\vw^{\ast})\|^{2}+4\tau\alpha_{t-1}^{2}l\langle\ov{w}_{t-1}-\vw^{\ast},\vH(\ov{w}_{t-1}-\vw^{\ast})\rangle\\
	& \leq(1-c\frac{N}{8(\tau+1)(\nu_{\max}\kappa_{1}+(N-\nu_{\min}))})\mathbb{E}\|\ov{w}_{t-\tau}-\vw^{\ast}\|^{2}
	\end{align*}
	which gives 
	\begin{align*}
	\mathbb{E}\|\ov{w}_{t}-\vw^{\ast}\|^{2} & \leq(1-c\frac{1}{8E}\frac{N}{(\nu_{\max}\kappa_{1}+(N-\nu_{\min}))})^{t}\|\vw_{0}-\vw^{\ast}\|^{2}\\
	& =O(\exp(-\frac{1}{E}\frac{N}{(\nu_{\max}\kappa_{1}+(N-\nu_{\min}))}t))\|\vw_{0}-\vw^{\ast}\|^{2}
	\end{align*}
	and with partial participation, the same bound holds with a possibly
	different choice of $c$. 
\end{proof}
	
	
	\subsection{Geometric Convergence of FedMaSS for Overparameterized Linear Regression}
	
	\begin{thm}
	For the overparamterized linear regression problem, FedMaSS with communication every $E$ iterations and constant
	step sizes $\overline{\eta}_1=\mathcal{O}(\frac{1}{E}\frac{N}{l\nu_{\max}+\mu(N-\nu_{\min})}),\overline{\eta}_{2}=\frac{\overline{\eta}_{1}(1-\frac{1}{\tilde{\kappa}})}{1+\frac{1}{\sqrt{\kappa_{1}\tilde{\kappa}}}},\overline{\gamma}=\frac{1-\frac{1}{\sqrt{\kappa_{1}\tilde{\kappa}}}}{1+\frac{1}{\sqrt{\kappa_{1}\tilde{\kappa}}}}$
	has geometric convergence:
	\begin{align*}
	\mathbb{E}F(\overline{\mathbf{w}}_{T}) & \leq\mathcal{O}\left(L\exp(-\frac{NT}{E(\nu_{\max}\sqrt{\kappa_{1}\tilde{\kappa}}+(N-\nu_{\min}))})\|\mathbf{w}_{0}-\mathbf{w}^{\ast}\|^{2}\right).
	\end{align*}
	\end{thm}
	\begin{proof}
		
		Note that the update can equivalently be written as 
		\begin{align*}
		\mathbf{v}_{t+1}^{k} & =(1-\alpha^{k})\mathbf{v}_{t}^{k}+\alpha^{k}\mathbf{u}_{t}^{k}-\delta^{k}g_{t,k}\\
		\mathbf{w}_{t+1}^{k} & =\begin{cases}
		\mathbf{u}_{t}^{k}-\eta^{k}g_{t,k} & \text{if }t+1\notin\mathcal{I}_{E}\\
		\sum_{k=1}^{N}p_{k}\left[\mathbf{u}_{t}^{k}-\eta^{k}g_{t,k}\right] & \text{if }t+1\in\mathcal{I}_{E}
		\end{cases}\\
		\mathbf{u}_{t+1}^{k} & =\frac{\alpha^{k}}{1+\alpha^{k}}\mathbf{v}_{t+1}^{k}+\frac{1}{1+\alpha^{k}}\mathbf{w}_{t+1}^{k}
		\end{align*}
		where there is a bijection between the parameters $\frac{1-\alpha^{k}}{1+\alpha^{k}}=\gamma^{k},\eta^{k}=\eta_{1}^{k},\frac{\eta^{k}-\alpha^{k}\delta^{k}}{1+\alpha^{k}}=\eta_{2}^{k}$,
		and we further introduce an auxiliary parameter $\mathbf{v}_{t}^{k}$,
		which is initialized at $\mathbf{v}_{0}^{k}$. We also note that when
		$\delta^{k}=\frac{\eta^{k}}{\alpha^{k}}$, the update reduces to the
		Nesterov accelerated SGD. This version of the FedAvg algorithm with
		local MaSS updates is used for analyzing the geometric convergence. 
		
		As before, define the virtual sequences $\overline{\mathbf{w}}_{t}=\sum_{k=1}^{N}p_{k}\mathbf{w}_{t}^{k}$,
		$\overline{\mathbf{v}}_{t}=\sum_{k=1}^{N}p_{k}\mathbf{v}_{t}^{k}$,
		$\overline{\mathbf{u}}_{t}=\sum_{k=1}^{N}p_{k}\mathbf{u}_{t}^{k}$,
		and $\overline{g}_{t}=\sum_{k=1}^{N}p_{k}\mathbb{E}g_{t,k}$. We have
		$\mathbb{E}g_{t}=\overline{g}_{t}$ and $\overline{\mathbf{w}}_{t+1}=\overline{\mathbf{u}}_{t}-\eta_{t}g_{t}$,
		$\overline{\mathbf{v}}_{t+1}=(1-\alpha^{k})\overline{\mathbf{v}}_{t}+\alpha^{k}\overline{\mathbf{w}}_{t}-\delta^{k}g_{t}$,
		and $\overline{\mathbf{u}}_{t+1}=\frac{\alpha^{k}}{1+\alpha^{k}}\overline{\mathbf{v}}_{t+1}+\frac{1}{1+\alpha^{k}}\overline{\mathbf{w}}_{t+1}$.
		
		We first prove the theorem with $E=2$ and $t-1$ being a communication
		round. We have 
		\begin{align*}
		& \|\overline{\mathbf{v}}_{t+1}-\mathbf{w}^{\ast}\|_{H^{-1}}^{2}\\
		& =\|(1-\alpha)\overline{v}_{t}+\alpha\overline{u}_{t}-\delta\sum_{k}p_{k}\tilde{H}_{t}^{k}(u_{t}^{k}-w^{\ast})-w^{\ast}\|_{H^{-1}}^{2}\\
		& =\|(1-\alpha)\overline{v}_{t}+\alpha\overline{u}_{t}-w^{\ast}\|_{H^{-1}}^{2}+\delta^{2}\|\sum_{k}p_{k}\tilde{H}_{t}^{k}(u_{t}^{k}-w^{\ast})\|_{H^{-1}}^{2}\\
		& -2\delta\langle\sum_{k}p_{k}\tilde{H}_{t}^{k}(u_{t}^{k}-w^{\ast}),(1-\alpha)\overline{v}_{t}+\alpha\overline{u}_{t}-w^{\ast}\rangle_{H^{-1}}\\
		& \leq\underset{A}{\underbrace{\|(1-\alpha)\overline{v}_{t}+\alpha\overline{u}_{t}-w^{\ast}\|_{H^{-1}}^{2}}}+\underset{B}{\underbrace{2\delta^{2}\|\sum_{k}p_{k}\tilde{H}_{t}^{k}(\overline{u}_{t}-w^{\ast})\|_{H^{-1}}^{2}}}+2\delta^{2}\|\sum_{k}p_{k}\tilde{H}_{t}^{k}(\overline{u}_{t}-u_{t}^{k})\|_{H^{-1}}^{2}\\
		& \underset{C}{\underbrace{-2\delta\langle\sum_{k}p_{k}\tilde{H}_{t}^{k}(\overline{u}_{t}-w^{\ast}),(1-\alpha)\overline{v}_{t}+\alpha\overline{u}_{t}-w^{\ast}\rangle_{H^{-1}}}}\\
		& -2\delta\langle\sum_{k}p_{k}\tilde{H}_{t}^{k}(u_{t}^{k}-\overline{u}_{t}),(1-\alpha)\overline{v}_{t}+\alpha\overline{u}_{t}-w^{\ast}\rangle_{H^{-1}}
		\end{align*}
		Following the proof in, 
		\begin{align*}
		\mathbb{E}A & \leq\mathbb{E}(1-\alpha)\|\overline{v}_{t}-w^{\ast}\|_{H^{-1}}^{2}+\alpha\|\overline{u}_{t}-w^{\ast}\|_{H^{-1}}^{2}\\
		& \leq\mathbb{E}(1-\alpha)\|\overline{v}_{t}-w^{\ast}\|_{H^{-1}}^{2}+\frac{\alpha}{\mu}\|\overline{u}_{t}-w^{\ast}\|^{2}
		\end{align*}
		using the convexity of the norm $\|\cdot\|_{H^{-1}}$ and that $\mu$
		is the smallest non-zero eigenvalue of $H$. 
		
		Now 
		\begin{align*}
		\mathbb{E}B & \leq2\delta^{2}(\nu_{\max}\frac{1}{N}\tilde{\kappa}+\frac{N-\nu_{\min}}{N})\|(\overline{u}_{t}-w^{\ast})\|_{H}^{2}
		\end{align*}
		using the folowing bound: 
		\begin{align*}
		\mathbb{E}\left(\sum_{k}p_{k}\tilde{H}_{t}^{k}\right)H^{-1}\left(\sum_{k}p_{k}\tilde{H}_{t}^{k}\right) & =\mathbb{E}\sum_{k}p_{k}^{2}\tilde{H}_{t}^{k}H^{-1}\tilde{H}_{t}^{k}+\sum_{k\neq j}p_{k}p_{j}\tilde{H}_{t}^{k}H^{-1}\tilde{H}_{t}^{j}\\
		& \preceq\nu_{\max}\frac{1}{N}\mathbb{E}\sum_{k}p_{k}\tilde{H}_{t}^{k}H^{-1}\tilde{H}_{t}^{k}+\sum_{k\neq j}p_{k}p_{j}H^{k}H^{-1}H^{j}\\
		& =\nu_{\max}\frac{1}{N}\mathbb{E}\sum_{k}p_{k}\tilde{H}_{t}^{k}H^{-1}\tilde{H}_{t}^{k}+\sum_{k,j}p_{k}p_{j}H^{k}H^{-1}H^{j}-\sum_{k}p_{k}^{2}H^{k}H^{-1}H^{k}\\
		& \preceq\nu_{\max}\frac{1}{N}\mathbb{E}\sum_{k}p_{k}\tilde{H}_{t}^{k}H^{-1}\tilde{H}_{t}^{k}+H-\frac{1}{N}\nu_{\min}\sum_{k}p_{k}H^{k}H^{-1}H^{k}\\
		& \preceq\nu_{\max}\frac{1}{N}\mathbb{E}\sum_{k}p_{k}\tilde{H}_{t}^{k}H^{-1}\tilde{H}_{t}^{k}+H-\frac{1}{N}\nu_{\min}(\sum_{k}p_{k}H^{k})H^{-1}(\sum_{k}p_{k}H^{k})\\
		& =\nu_{\max}\frac{1}{N}\mathbb{E}\sum_{k}p_{k}\tilde{H}_{t}^{k}H^{-1}\tilde{H}_{t}^{k}+\frac{N-\nu_{\min}}{N}H\\
		& \preceq\nu_{\max}\frac{1}{N}\tilde{\kappa}H+\frac{N-\nu_{\min}}{N}H
		\end{align*}
		where we have used $\mathbb{E}\sum_{k}p_{k}\tilde{H}_{t}^{k}H^{-1}\tilde{H}_{t}^{k}\leq\tilde{\kappa}H$
		by definition of $\tilde{\kappa}$ and the operator convexity of the
		mapping $W\rightarrow WH^{-1}W$.
		
		Finally, 
		\begin{align*}
		\mathbb{E}C & =-\mathbb{E}2\delta\langle\sum_{k}p_{k}\tilde{H}_{t}^{k}(\overline{u}_{t}-w^{\ast}),(1-\alpha)\overline{v}_{t}+\alpha\overline{u}_{t}-w^{\ast}\rangle_{H^{-1}}\\
		& =-2\delta\langle\sum_{k}p_{k}H^{k}(\overline{u}_{t}-w^{\ast}),(1-\alpha)\overline{v}_{t}+\alpha\overline{u}_{t}-w^{\ast}\rangle_{H^{-1}}\\
		& =-2\delta\langle(\overline{u}_{t}-w^{\ast}),(1-\alpha)\overline{v}_{t}+\alpha\overline{u}_{t}-w^{\ast}\rangle\\
		& =-2\delta\langle(\overline{u}_{t}-w^{\ast}),\overline{u}_{t}-w^{\ast}+\frac{1-\alpha}{\alpha}(\overline{u}_{t}-\overline{w}_{t})\rangle\\
		& =-2\delta\|\overline{u}_{t}-w^{\ast}\|^{2}+\frac{1-\alpha}{\alpha}\delta(\|\overline{w}_{t}-w^{\ast}\|^{2}-\|\overline{u}_{t}-w^{\ast}\|^{2}-\|\overline{w}_{t}-\overline{u}_{t}\|^{2})\\
		& \leq\frac{1-\alpha}{\alpha}\delta\|\overline{w}_{t}-w^{\ast}\|^{2}-\frac{1-\alpha}{\alpha}\delta\|\overline{u}_{t}-w^{\ast}\|^{2}
		\end{align*}
		where we have used 
		\begin{align*}
		& (1-\alpha)\overline{v}_{t}+\alpha\overline{u}_{t}\\
		& =(1-\alpha)((1+\alpha)\overline{u}_{t}-\overline{w}_{t})/\alpha+\alpha\overline{u}_{t}\\
		& =\frac{1}{\alpha}\overline{u}_{t}-\frac{1-\alpha}{\alpha}\overline{w}_{t}
		\end{align*}
		and the identity that $-2\langle a,b\rangle=\|a\|^{2}+\|b\|^{2}-\|a+b\|^{2}$. 
		
		It follows that 
		\begin{align*}
		& \mathbb{E}\|\overline{v}_{t+1}-w^{\ast}\|_{H^{-1}}^{2}\\
		& \leq(1-\alpha)\|\overline{v}_{t}-w^{\ast}\|_{H^{-1}}^{2}+\frac{1-\alpha}{\alpha}\delta\|\overline{w}_{t}-w^{\ast}\|^{2}\\
		& +(\frac{\alpha}{\mu}-\frac{1-\alpha}{\alpha}\delta)\|\overline{u}_{t}-w^{\ast}\|^{2}+2\delta^{2}(\nu_{\max}\frac{1}{N}\tilde{\kappa}+\frac{N-\nu_{\min}}{N})\|(\overline{u}_{t}-w^{\ast})\|_{H}^{2}\\
		& +2\delta^{2}\|\sum_{k}p_{k}\tilde{H}_{t}^{k}(\overline{u}_{t}-u_{t}^{k})\|_{H^{-1}}^{2}\\
		& -2\delta\langle\sum_{k}p_{k}\tilde{H}_{t}^{k}(u_{t}^{k}-\overline{u}_{t}),(1-\alpha)\overline{v}_{t}+\alpha\overline{u}_{t}-w^{\ast}\rangle_{H^{-1}}
		\end{align*}
		
		On the other hand, 
		\begin{align*}
		\mathbb{E}\|\overline{w}_{t+1}-w^{\ast}\|^{2} & =\mathbb{E}\|\overline{u}_{t}-w^{\ast}-\eta\sum_{k}p_{k}\tilde{H}_{t}^{k}(\overline{u}_{t}-w^{\ast})\|^{2}\\
		& =\mathbb{E}\|\overline{u}_{t}-w^{\ast}\|^{2}-2\eta\|\overline{u}_{t}-w^{\ast}\|_{H}^{2}+\eta^{2}\|\sum_{k}p_{k}\tilde{H}_{t}^{k}(\overline{u}_{t}-w^{\ast})\|^{2}\\
		& \leq\mathbb{E}\|\overline{u}_{t}-w^{\ast}\|^{2}-2\eta\|\overline{u}_{t}-w^{\ast}\|_{H}^{2}+\eta^{2}(\nu_{\max}\frac{1}{N}\ell+L\frac{N-\nu_{\min}}{N})\|\overline{u}_{t}-w^{\ast}\|^{2}
		\end{align*}
		where we use the following bound: 
		\begin{align*}
		& \mathbb{E}\left(\sum_{k}p_{k}\tilde{H}_{t}^{k}\right)\left(\sum_{k}p_{k}\tilde{H}_{t}^{k}\right)\\
		& =\mathbb{E}\sum_{k}p_{k}^{2}\tilde{H}_{t}^{k}\tilde{H}_{t}^{k}+\sum_{k\neq j}p_{k}p_{j}\tilde{H}_{t}^{k}\tilde{H}_{t}^{j}\\
		& \preceq\nu_{\max}\frac{1}{N}\mathbb{E}\sum_{k}p_{k}\tilde{H}_{t}^{k}\tilde{H}_{t}^{k}+\sum_{k\neq j}p_{k}p_{j}H^{k}H^{j}\\
		& =\nu_{\max}\frac{1}{N}\mathbb{E}\sum_{k}p_{k}\tilde{H}_{t}^{k}\tilde{H}_{t}^{k}+\sum_{k,j}p_{k}p_{j}H^{k}H^{j}-\sum_{k}p_{k}^{2}H^{k}H^{k}\\
		& \preceq\nu_{\max}\frac{1}{N}\mathbb{E}\sum_{k}p_{k}\tilde{H}_{t}^{k}\tilde{H}_{t}^{k}+H^{2}-\frac{1}{N}\nu_{\min}\sum_{k}p_{k}H^{k}H^{k}\\
		& \preceq\nu_{\max}\frac{1}{N}\mathbb{E}\sum_{k}p_{k}\tilde{H}_{t}^{k}\tilde{H}_{t}^{k}+H^{2}-\frac{1}{N}\nu_{\min}(\sum_{k}p_{k}H^{k})(\sum_{k}p_{k}H^{k})\\
		& =\nu_{\max}\frac{1}{N}\mathbb{E}\sum_{k}p_{k}\tilde{H}_{t}^{k}\tilde{H}_{t}^{k}+\frac{N-\nu_{\min}}{N}H^{2}\\
		& \preceq\nu_{\max}\frac{1}{N}lH+L\frac{N-\nu_{\min}}{N}H
		\end{align*}
		again using that $W\rightarrow W^{2}$ is operator convex and that
		$\mathbb{E}\tilde{H}_{t}^{k}\tilde{H}_{t}^{k}\preceq lH^{k}$ by definition
		of $l$. 
		
		Combining the bounds for $\mathbb{E}\|\overline{w}_{t+1}-w^{\ast}\|^{2}$
		and $\mathbb{E}\|\overline{v}_{t+1}-w^{\ast}\|_{H^{-1}}^{2}$, 
		\begin{align*}
		& \mathbb{E}\frac{\delta}{\alpha}\|\overline{w}_{t+1}-w^{\ast}\|^{2}+\|\overline{v}_{t+1}-w^{\ast}\|_{H^{-1}}^{2}\\
		& \leq(1-\alpha)\|\overline{v}_{t}-w^{\ast}\|_{H^{-1}}^{2}+\frac{1-\alpha}{\alpha}\delta\|\overline{w}_{t}-w^{\ast}\|^{2}+(\frac{\alpha}{\mu}-\delta)\|\overline{u}_{t}-w^{\ast}\|^{2}\\
		& +(2\delta^{2}(\nu_{\max}\frac{1}{N}\tilde{\kappa}+\frac{N-\nu_{\min}}{N})-2\eta\delta/\alpha+\eta^{2}\delta(\nu_{\max}\frac{1}{N}l+L\frac{N-\nu_{\min}}{N})/\alpha)\|\overline{u}_{t}-w^{\ast}\|^{2}\\
		& +2\delta^{2}\|\sum_{k}p_{k}\tilde{H}_{t}^{k}(\overline{u}_{t}-u_{t}^{k})\|_{H^{-1}}^{2}\\
		& +\delta L\sum_{k}p_{k}\|(\overline{u}_{t}-u_{t}^{k})\|_{H^{-1}}^{2}
		\end{align*}
		
		Choosing step sizes so that 
		\begin{align*}
		\frac{\alpha}{\mu}-\delta & \leq0\\
		2\delta^{2}(\nu_{\max}\frac{1}{N}\tilde{\kappa}+\frac{N-\nu_{\min}}{N})-2\eta\delta/\alpha+\eta^{2}\delta(\nu_{\max}\frac{1}{N}l+L\frac{N-\nu_{\min}}{N})/\alpha & \leq0
		\end{align*}
		or equivalently 
		\begin{align*}
		\alpha/\delta & \leq\mu\\
		2\alpha\delta(\nu_{\max}\frac{1}{N}\tilde{\kappa}+\frac{N-\nu_{\min}}{N})+\eta(\eta(\nu_{\max}\frac{1}{N}l+L\frac{N-\nu_{\min}}{N})-2) & \leq0
		\end{align*}
		the second and third terms are negative. To optimize the step sizes,
		note that the two inequalities imply 
		\begin{align*}
		\alpha^{2} & \leq\eta(2-\eta(\nu_{\max}\frac{1}{N}l+L\frac{N-\nu_{\min}}{N}))\mu/2(\nu_{\max}\frac{1}{N}\tilde{\kappa}+\frac{N-\nu_{\min}}{N})
		\end{align*}
		and maximizing the right hand side with respect to $\eta$, which
		is quadratic, we see that $\eta\equiv1/(\nu_{\max}\frac{1}{N}l+L\frac{N-\nu_{\min}}{N})$
		maximizes the right hand side, with 
		\begin{align*}
		\alpha & \equiv\frac{1}{\sqrt{2(\nu_{\max}\frac{1}{N}\kappa_{1}+\kappa\frac{N-\nu_{\min}}{N})(\nu_{\max}\frac{1}{N}\tilde{\kappa}+\frac{N-\nu_{\min}}{N})}}\\
		\delta & \equiv\frac{\alpha}{\mu}=\frac{\eta}{\alpha(\nu_{\max}\frac{1}{N}\tilde{\kappa}+\frac{N-\nu_{\min}}{N})}
		\end{align*}
		
		Note that $\alpha=\frac{1}{\sqrt{2(\nu_{\max}\frac{1}{N}\kappa_{1}+\kappa\frac{N-\nu_{\min}}{N})(\nu_{\max}\frac{1}{N}\tilde{\kappa}+\frac{N-\nu_{\min}}{N})}}=O(\frac{N}{\sqrt{\kappa_{1}\tilde{\kappa}}})$
		when $N=O(\min\{\tilde{\kappa},\kappa_{1}/\kappa\})$. Finally, to
		deal with the terms $2\delta^{2}\|\sum_{k}p_{k}\tilde{H}_{t}^{k}(\overline{u}_{t}-u_{t}^{k})\|_{H^{-1}}^{2}+\delta L\sum_{k}p_{k}\|(\overline{u}_{t}-u_{t}^{k})\|_{H^{-1}}^{2}$,
		we can use Jensen
		\begin{align*}
		&2\delta^{2}\|\sum_{k}p_{k}\tilde{H}_{t}^{k}(\overline{u}_{t}-u_{t}^{k})\|_{H^{-1}}^{2}+\delta L\sum_{k}p_{k}\|(\overline{u}_{t}-u_{t}^{k})\|_{H^{-1}}^{2} \\
		& \leq(2\delta^{2}l^{2}+\delta L)\sum_{k}p_{k}\|\overline{u}_{t}-u_{t}^{k}\|_{H^{-1}}^{2}\\
		& =(2\delta^{2}l^{2}+\delta L)\sum_{k}p_{k}\|\frac{\alpha}{1+\alpha}\overline{v}_{t}+\frac{1}{1+\alpha}\overline{w}_{t}-(\frac{\alpha}{1+\alpha}v_{t}^{k}+\frac{1}{1+\alpha}w_{t}^{k})\|_{H^{-1}}^{2}\\
		& \leq(2\delta^{2}l^{2}+\delta L)(2(\frac{\alpha}{1+\alpha})^{2}\delta^{2}+2(\frac{1}{1+\alpha})^{2}\eta^{2})\sum_{k}p_{k}\|\tilde{H}_{t-1}^{k}(\overline{u}_{t-1}-w^{\ast})\|^{2}\\
		& \leq(2\delta^{2}l^{2}+\delta L)(2(\frac{\alpha}{1+\alpha})^{2}\delta^{2}+2(\frac{1}{1+\alpha})^{2}\eta^{2})l^{2}\|(\overline{u}_{t-1}-w^{\ast})\|^{2}
		\end{align*}
		which can be combined with the terms with $\|(\overline{u}_{t-1}-w^{\ast})\|^{2}$
		in the recursive expansion of $\mathbb{E}\frac{\delta}{\alpha}\|\overline{w}_{t}-w^{\ast}\|^{2}+\|\overline{v}_{t}-w^{\ast}\|_{H^{-1}}^{2}$:
		\begin{align*}
		& \mathbb{E}\frac{\delta}{\alpha}\|\overline{w}_{t}-w^{\ast}\|^{2}+\|\overline{v}_{t}-w^{\ast}\|_{H^{-1}}^{2}\\
		& \leq(1-\alpha)\|\overline{v}_{t-1}-w^{\ast}\|_{H^{-1}}^{2}+\frac{1-\alpha}{\alpha}\delta\|\overline{w}_{t-1}-w^{\ast}\|^{2}+(\frac{\alpha}{\mu}-\delta)\|\overline{u}_{t-1}-w^{\ast}\|^{2}\\
		& +(2\delta^{2}(\nu_{\max}\frac{1}{N}\tilde{\kappa}+\frac{N-\nu_{\min}}{N})-2\eta\delta/\alpha+\eta^{2}\delta(\nu_{\max}\frac{1}{N}l+L\frac{N-\nu_{\min}}{N})/\alpha)\|\overline{u}_{t-1}-w^{\ast}\|^{2}
		\end{align*}
		and the step sizes can be chosen so that the resulting coefficients
		are negative. Therefore, we have shown that 
		\begin{align*}
		\mathbb{E}\|\overline{w}_{t+1}-w^{\ast}\|^{2} & \leq(1-\alpha)^{2}\|\overline{w}_{t-1}-w^{\ast}\|^{2}
		\end{align*}
		where $\alpha=\frac{1}{\sqrt{2(\nu_{\max}\frac{1}{N}\kappa_{1}+\kappa\frac{N-\nu_{\min}}{N})(\nu_{\max}\frac{1}{N}\tilde{\kappa}+\frac{N-\nu_{\min}}{N})}}=O(\frac{N}{\nu_{\max}\sqrt{\kappa_{1}\tilde{\kappa}}+N-\nu_{\min}})$
		when $N=O(\min\{\tilde{\kappa},\kappa_{1}/\kappa\})$.
		
		For general $E>1$, choosing $\eta=c/E(\nu_{\max}\frac{1}{N}l+L\frac{N-\nu_{\min}}{N})$
		for some small constant $c$ results in $\alpha=O(\frac{1}{E\sqrt{(\nu_{\max}\frac{1}{N}\kappa_{1}+\kappa\frac{N-\nu_{\min}}{N})(\nu_{\max}\frac{1}{N}\tilde{\kappa}+\frac{N-\nu_{\min}}{N})}})$
		and this guarantees that 
		\begin{align*}
		\mathbb{E}\|\overline{w}_{t}-w^{\ast}\|^{2} & \leq(1-\alpha)^{t}\|w_{0}-w^{\ast}\|^{2}
		\end{align*}
		for all $t$. 
		
		
	\end{proof}